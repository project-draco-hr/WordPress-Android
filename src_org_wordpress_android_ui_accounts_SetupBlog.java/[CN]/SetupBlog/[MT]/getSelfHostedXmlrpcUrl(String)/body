{
  String xmlrpcUrl=null;
  if (!Charset.forName("US-ASCII").newEncoder().canEncode(url)) {
    if (url.toLowerCase().startsWith("http://")) {
      url="http://" + IDN.toASCII(url.substring(7));
    }
 else     if (url.toLowerCase().startsWith("https://")) {
      url="https://" + IDN.toASCII(url.substring(8));
    }
 else {
      url=IDN.toASCII(url);
    }
  }
  if (!(url.toLowerCase().startsWith("http://")) && !(url.toLowerCase().startsWith("https://"))) {
    if (mAllSslCertificatesTrusted) {
      url="https://" + url;
    }
 else {
      url="http://" + url;
    }
  }
  if (!URLUtil.isValidUrl(url)) {
    mErrorMsgId=R.string.invalid_url_message;
    return null;
  }
  String rsdUrl;
  try {
    rsdUrl=getRsdUrl(url,mAllSslCertificatesTrusted);
  }
 catch (  SSLHandshakeException e) {
    mErroneousSslCertificate=true;
    AppLog.w(T.NUX,"SSLHandshakeException failed. Erroneous SSL certificate detected.");
    return null;
  }
  try {
    if (rsdUrl != null) {
      xmlrpcUrl=ApiHelper.getXMLRPCUrl(rsdUrl,mAllSslCertificatesTrusted);
      if (xmlrpcUrl == null) {
        xmlrpcUrl=rsdUrl.replace("?rsd","");
      }
    }
 else {
      xmlrpcUrl=getmXmlrpcByUserEnteredPath(url);
    }
  }
 catch (  SSLHandshakeException e) {
  }
  return xmlrpcUrl;
}
