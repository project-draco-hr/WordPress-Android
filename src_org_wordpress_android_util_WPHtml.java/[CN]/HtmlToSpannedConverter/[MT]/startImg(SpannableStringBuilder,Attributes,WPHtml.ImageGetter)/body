{
  String src=attributes.getValue("android-uri");
  ImageHelper ih=new ImageHelper();
  Map<String,Object> mediaData=ih.getImageBytesForPath(src,ctx);
  if (mediaData != null || src.contains("video")) {
    Bitmap resizedBitmap;
    if (mediaData != null)     resizedBitmap=ih.getThumbnailForWPImageSpan(ctx,(byte[])mediaData.get("bytes"),(String)mediaData.get("orientation"));
 else     resizedBitmap=BitmapFactory.decodeResource(ctx.getResources(),R.drawable.media_movieclip);
    int len=text.length();
    text.append("\uFFFC");
    Uri curStream=Uri.parse(src);
    if (curStream == null) {
      return;
    }
    WPImageSpan is=new WPImageSpan(ctx,resizedBitmap,curStream);
    MediaFile mf=WordPress.wpDB.getMediaFile(src,post);
    if (mf != null) {
      is.setMediaFile(mf);
      is.setImageSource(curStream);
      text.setSpan(is,len,text.length(),Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
      AlignmentSpan.Standard as=new AlignmentSpan.Standard(Layout.Alignment.ALIGN_CENTER);
      text.setSpan(as,text.getSpanStart(is),text.getSpanEnd(is),Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
  }
 else   if (post != null) {
    if (post.isLocalDraft()) {
      if (attributes != null) {
        text.append("<img");
        for (int i=0; i < attributes.getLength(); i++) {
          String aName=attributes.getLocalName(i);
          if ("".equals(aName))           aName=attributes.getQName(i);
          text.append(" ");
          text.append(aName + "=\"" + attributes.getValue(i)+ "\"");
        }
        text.append(" />\n");
      }
    }
  }
}
