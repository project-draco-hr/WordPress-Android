{
  Intent intent=getIntent();
  String text=intent.getStringExtra(Intent.EXTRA_TEXT);
  if (text != null) {
    EditText contentET=(EditText)findViewById(R.id.content);
    if (text.contains("youtube_gdata")) {
      text=text.replace("&feature=youtube_gdata","");
      text=text.replace("watch?v=","v/");
      text="<object width=\"480\" height=\"385\"><param name=\"movie\" value=\"" + text + "\"></param><param name=\"allowFullScreen\" value=\"true\"></param><param name=\"allowscriptaccess\" value=\"always\"></param><embed src=\""+ text+ "\" type=\"application/x-shockwave-flash\" allowscriptaccess=\"always\" allowfullscreen=\"true\" width=\"480\" height=\"385\"></embed></object>";
      text=escapeUtils.escapeHtml(text);
      contentET.setText(text);
    }
 else {
      String[] parts=text.split("\\s");
      String finalText="";
      for (      String item : parts)       try {
        URL url=new URL(item);
        finalText+="<a href=\"" + url + "\">"+ url+ "</a> ";
        contentET.setText(Html.fromHtml(finalText));
        isUrl=true;
      }
 catch (      MalformedURLException e) {
        finalText+=item + " ";
        contentET.setText(finalText);
      }
    }
  }
  String action=intent.getAction();
  String type=intent.getType();
  ArrayList multi_stream;
  if (Intent.ACTION_SEND_MULTIPLE.equals(action)) {
    multi_stream=intent.getParcelableArrayListExtra((Intent.EXTRA_STREAM));
  }
 else {
    multi_stream=new ArrayList();
    multi_stream.add((Uri)intent.getParcelableExtra(Intent.EXTRA_STREAM));
  }
  for (int i=0; i < multi_stream.size(); i++) {
    Uri curStream=(Uri)multi_stream.get(i);
    if (curStream != null && type != null) {
      String imgPath=curStream.getEncodedPath();
      addMedia(imgPath,curStream);
    }
  }
}
