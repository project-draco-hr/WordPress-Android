{
  if (data != null) {
    List<MediaItem> selectedContent=data.getParcelableArrayListExtra(MediaPickerActivity.SELECTED_CONTENT_RESULTS_KEY);
    if (selectedContent != null && selectedContent.size() > 0) {
      if (selectedContent.size() == 1) {
        addMedia(selectedContent.get(0).getSource(),null,getActivity());
      }
 else {
        Editable editableText=mContentEditText.getText();
        WPCollectionSpan collectionSpan=new WPCollectionSpan(getActivity(),ImageUtils.getWPImageSpanThumbnailFromFilePath(getActivity(),selectedContent.get(0).getSource().toString(),getMaximumThumbnailWidth()));
        int selectionStart=mContentEditText.getSelectionStart();
        int selectionEnd=mContentEditText.getSelectionEnd();
        for (        final MediaItem selectedItem : selectedContent) {
          collectionSpan.addContent(selectedItem.getSource().toString());
        }
        if (selectionStart > selectionEnd) {
          int temp=selectionEnd;
          selectionEnd=selectionStart;
          selectionStart=temp;
        }
        int line, column=0;
        if (mContentEditText.getLayout() != null) {
          line=mContentEditText.getLayout().getLineForOffset(selectionStart);
          column=mContentEditText.getSelectionStart() - mContentEditText.getLayout().getLineStart(line);
        }
        if (column != 0) {
          editableText.insert(selectionEnd,"\n");
          selectionStart=selectionStart + 1;
          selectionEnd=selectionEnd + 1;
        }
        editableText.insert(selectionStart," ");
        editableText.setSpan(collectionSpan,selectionStart,selectionEnd + 1,Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
        editableText.insert(selectionStart,"\n");
      }
    }
  }
}
