{
  if (data != null) {
    List<MediaItem> selectedContent=data.getParcelableArrayListExtra(MediaPickerActivity.SELECTED_CONTENT_RESULTS_KEY);
    if (selectedContent != null && selectedContent.size() > 0) {
      for (      MediaItem content : selectedContent) {
        Uri source=content.getSource();
        final String id=content.getTag();
        if (source != null && id != null) {
          final String sourceString=source.toString();
          if (sourceString.contains("wordpress.com")) {
            mGalleryIds.add(id);
            AnalyticsTracker.track(Stat.EDITOR_ADDED_PHOTO_VIA_WP_MEDIA_LIBRARY);
          }
 else           if (MediaUtils.isValidImage(sourceString)) {
            queueFileForUpload(sourceString);
            addMedia(source,null,getActivity());
            AnalyticsTracker.track(Stat.EDITOR_ADDED_PHOTO_VIA_LOCAL_LIBRARY);
          }
        }
      }
      if (mUploadingMedia.size() > 0) {
        String galleryToast=getString(R.string.editor_toast_gallery_pending_formatted,mUploadingMedia.size());
        ToastUtils.showToast(getActivity(),galleryToast,ToastUtils.Duration.SHORT);
      }
 else {
        createGallery();
      }
    }
  }
}
