{
  if (context == null || !AccountHelper.isSignedInWordPressDotCom()) {
    return;
  }
  SharedPreferences settings=PreferenceManager.getDefaultSharedPreferences(context);
  String deviceID=settings.getString(WPCOM_PUSH_DEVICE_SERVER_ID,null);
  if (TextUtils.isEmpty(deviceID)) {
    AppLog.e(T.NOTIFS,"device_ID is null in preferences. Set device settings skipped.");
    return;
  }
  String settingsJson=settings.getString(WPCOM_PUSH_DEVICE_NOTIFICATION_SETTINGS,null);
  if (settingsJson == null) {
    AppLog.e(T.NOTIFS,"Notifications settings JSON not found in app preferences.");
    return;
  }
  Gson gson=new Gson();
  Map notificationSettings=gson.fromJson(settingsJson,HashMap.class);
  Map<String,Object> updatedSettings=new HashMap<>();
  ArrayList<StringMap> mutedBlogsList=new ArrayList<>();
  if (notificationSettings == null || !(notificationSettings.get(WPCOM_PUSH_KEY_MUTED_BLOGS) instanceof StringMap) || !(notificationSettings.get(WPCOM_PUSH_KEY_MUTE_UNTIL) instanceof StringMap)) {
    return;
  }
  StringMap<?> mutedBlogsMap=(StringMap)notificationSettings.get(WPCOM_PUSH_KEY_MUTED_BLOGS);
  StringMap<?> muteUntilMap=(StringMap)notificationSettings.get(WPCOM_PUSH_KEY_MUTE_UNTIL);
  notificationSettings.remove(WPCOM_PUSH_KEY_MUTED_BLOGS);
  notificationSettings.remove(WPCOM_PUSH_KEY_MUTE_UNTIL);
  for (  Object entry : notificationSettings.entrySet()) {
    if (entry instanceof Map.Entry) {
      Map.Entry hashMapEntry=(Map.Entry)entry;
      if (hashMapEntry.getValue() instanceof StringMap && hashMapEntry.getKey() instanceof String) {
        StringMap setting=(StringMap)hashMapEntry.getValue();
        updatedSettings.put((String)hashMapEntry.getKey(),setting.get(WPCOM_PUSH_KEY_VALUE));
      }
    }
  }
  if (muteUntilMap != null && muteUntilMap.get(WPCOM_PUSH_KEY_VALUE) != null) {
    updatedSettings.put(WPCOM_PUSH_KEY_MUTE_UNTIL,muteUntilMap.get(WPCOM_PUSH_KEY_VALUE));
  }
  if (mutedBlogsMap.get(WPCOM_PUSH_KEY_VALUE) instanceof ArrayList) {
    ArrayList blogsList=(ArrayList)mutedBlogsMap.get(WPCOM_PUSH_KEY_VALUE);
    for (    Object userBlog : blogsList) {
      if (userBlog instanceof StringMap) {
        StringMap userBlogMap=(StringMap)userBlog;
        if (MapUtils.getMapBool(userBlogMap,WPCOM_PUSH_KEY_VALUE)) {
          mutedBlogsList.add(userBlogMap);
        }
      }
    }
  }
  if (updatedSettings.size() == 0 && mutedBlogsList.size() == 0) {
    return;
  }
  updatedSettings.put(WPCOM_PUSH_KEY_MUTED_BLOGS,mutedBlogsList);
  Map<String,String> contentStruct=new HashMap<>();
  contentStruct.put("settings",gson.toJson(updatedSettings));
  WordPress.getRestClientUtils().post("/device/" + deviceID,contentStruct,null,null,null);
}
