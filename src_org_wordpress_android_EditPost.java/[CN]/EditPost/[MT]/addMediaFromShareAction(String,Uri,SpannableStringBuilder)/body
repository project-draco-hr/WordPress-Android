{
  Bitmap resizedBitmap=null;
  String imageTitle="";
  ImageHelper ih=new ImageHelper();
  Display display=getWindowManager().getDefaultDisplay();
  int width=display.getWidth();
  HashMap<?,?> mediaData=ih.getImageBytesForPath(imgPath,EditPost.this);
  if (mediaData == null) {
    return null;
  }
  byte[] finalBytes=ih.createThumbnail((byte[])mediaData.get("bytes"),String.valueOf(width / 2),(String)mediaData.get("orientation"),true);
  resizedBitmap=BitmapFactory.decodeByteArray(finalBytes,0,finalBytes.length);
  WPImageSpan is=new WPImageSpan(EditPost.this,resizedBitmap,curStream);
  String imageWidth=WordPress.currentBlog.getMaxImageWidth();
  if (!imageWidth.equals("Original Size")) {
    try {
      is.setWidth(Integer.valueOf(imageWidth));
    }
 catch (    NumberFormatException e) {
      e.printStackTrace();
    }
  }
  is.setTitle(imageTitle);
  is.setImageSource(curStream);
  is.setVideo(imgPath.contains("video"));
  ssb.append(" ");
  ssb.setSpan(is,ssb.length() - 1,ssb.length(),Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
  AlignmentSpan.Standard as=new AlignmentSpan.Standard(Layout.Alignment.ALIGN_CENTER);
  ssb.setSpan(as,ssb.length() - 1,ssb.length(),Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
  ssb.append("\n");
  return ssb;
}
