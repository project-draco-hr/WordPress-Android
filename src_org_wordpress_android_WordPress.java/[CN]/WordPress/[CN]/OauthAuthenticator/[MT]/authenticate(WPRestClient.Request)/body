{
  String siteId=request.getSiteId();
  String token=null;
  Blog blog=null;
  if (siteId == null) {
    SharedPreferences settings=PreferenceManager.getDefaultSharedPreferences(WordPress.this);
    token=settings.getString(ACCESS_TOKEN_PREFERENCE,null);
  }
 else {
    blog=wpDB.getBlogForDotComBlogId(siteId);
    if (blog != null) {
      token=blog.getApi_key();
      if (token == null && blog.isDotcomFlag()) {
        SharedPreferences settings=PreferenceManager.getDefaultSharedPreferences(WordPress.this);
        token=settings.getString(ACCESS_TOKEN_PREFERENCE,null);
      }
    }
  }
  if (token != null) {
    request.sendWithAccessToken(token);
  }
 else {
    requestAccessToken(request,blog);
  }
}
