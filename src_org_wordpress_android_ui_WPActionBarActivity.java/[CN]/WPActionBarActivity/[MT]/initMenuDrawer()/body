{
  mListView=new ListView(this);
  mListView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
  mListView.setDivider(null);
  mListView.setDividerHeight(0);
  mListView.setCacheColorHint(android.R.color.transparent);
  mAdapter=new MenuAdapter(this);
  String[] blogNames=getBlogNames();
  if (blogNames.length > 1) {
    addBlogSpinner(blogNames);
  }
  mListView.setOnItemClickListener(new AdapterView.OnItemClickListener(){
    public void onItemClick(    AdapterView<?> parent,    View view,    int position,    long id){
      SharedPreferences settings=PreferenceManager.getDefaultSharedPreferences(WPActionBarActivity.this);
      SharedPreferences.Editor editor=settings.edit();
      MenuDrawerItem item=mAdapter.getItem(position);
      if (item.hasItemId())       editor.putInt(LAST_ACTIVITY_PREFERENCE,item.getItemId());
      Intent intent=null;
      if (!item.isSelected())       intent=item.selectItem();
      editor.commit();
      mMenuDrawer.closeMenu();
      if (intent != null)       startActivityWithDelay(intent);
    }
  }
);
  mListView.setOnScrollListener(new AbsListView.OnScrollListener(){
    @Override public void onScrollStateChanged(    AbsListView view,    int scrollState){
    }
    @Override public void onScroll(    AbsListView view,    int firstVisibleItem,    int visibleItemCount,    int totalItemCount){
      mMenuDrawer.invalidate();
    }
  }
);
  mMenuDrawer.setMenuView(mListView);
  mListView.setAdapter(mAdapter);
  mMenuItems.add(new MenuDrawerItem(READER_ACTIVITY,R.string.reader,R.drawable.dashboard_icon_subs){
    @Override public Boolean isVisible(){
      return WordPress.currentBlog != null && WordPress.currentBlog.isDotcomFlag();
    }
    @Override public Boolean isSelected(){
      return WPActionBarActivity.this instanceof ReaderActivity;
    }
    @Override public Intent onSelectItem(){
      if (!(WPActionBarActivity.this instanceof ReaderActivity))       mShouldFinish=true;
      int readerBlogID=WordPress.wpDB.getWPCOMBlogID();
      Intent intent=new Intent(WPActionBarActivity.this,ReaderActivity.class);
      intent.putExtra("id",readerBlogID);
      intent.setFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
      return intent;
    }
  }
);
  updateMenuDrawer();
}
