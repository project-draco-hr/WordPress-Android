{
  if (this.isInEditMode())   return;
  int variation=VARIATION_NORMAL;
  if (attrs != null) {
    TypedArray a=context.getTheme().obtainStyledAttributes(attrs,R.styleable.WPTextView,0,0);
    if (a != null) {
      try {
        variation=a.getInteger(R.styleable.WPTextView_fontVariation,VARIATION_NORMAL);
      }
  finally {
        a.recycle();
      }
    }
  }
  final int fontStyle;
  if (this.getTypeface() != null) {
    boolean isBold=this.getTypeface().isBold();
    boolean isItalic=this.getTypeface().isItalic();
    if (isBold && isItalic) {
      fontStyle=Typeface.BOLD_ITALIC;
    }
 else     if (isBold) {
      fontStyle=Typeface.BOLD;
    }
 else     if (isItalic) {
      fontStyle=Typeface.ITALIC;
    }
 else {
      fontStyle=Typeface.NORMAL;
    }
  }
 else {
    fontStyle=Typeface.NORMAL;
  }
  Typeface typeface=getCustomTypeface(context,fontStyle,variation);
  if (typeface != null)   setTypeface(typeface);
}
