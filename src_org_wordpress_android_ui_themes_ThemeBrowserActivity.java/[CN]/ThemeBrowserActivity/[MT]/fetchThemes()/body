{
  if (mFetchingThemes)   return;
  String siteId=getBlogId();
  mFetchingThemes=true;
  mProgressBar.setVisibility(View.VISIBLE);
  startAnimatingRefreshButton();
  WordPress.restClient.getThemes(siteId,0,0,new Listener(){
    @Override public void onResponse(    JSONObject response){
      new FetchThemesTask().execute(response);
    }
  }
,new ErrorListener(){
    @Override public void onErrorResponse(    VolleyError response){
      if (response.toString().equals(AuthFailureError.class.getName())) {
        String errorTitle=getString(R.string.theme_auth_error_title);
        String errorMsg=getString(R.string.theme_auth_error_message);
        if (!isDestroyed()) {
          FragmentTransaction ft=getSupportFragmentManager().beginTransaction();
          WPAlertDialogFragment fragment=WPAlertDialogFragment.newInstance(errorMsg,errorTitle,false);
          ft.add(fragment,"alert");
          ft.commitAllowingStateLoss();
        }
        Log.d("WordPress","Failed to fetch themes: failed authenticate user");
      }
 else {
        Toast.makeText(ThemeBrowserActivity.this,R.string.theme_fetch_failed,Toast.LENGTH_LONG).show();
        Log.d("WordPress","Failed to fetch themes: " + response.toString());
      }
      mFetchingThemes=false;
      mProgressBar.setVisibility(View.GONE);
      stopAnimatingRefreshButton();
      refreshViewPager();
    }
  }
);
}
