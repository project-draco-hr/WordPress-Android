{
  preShow();
  window.setAnimationStyle(R.style.Animations_PopUpMenu_Center);
  int[] location=new int[2];
  anchor.getLocationOnScreen(location);
  Rect anchorRect=new Rect(location[0],location[1],location[0] + anchor.getWidth(),location[1] + anchor.getHeight());
  root.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT));
  root.measure(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT);
  int rootWidth=root.getMeasuredWidth();
  int rootHeight=root.getMeasuredHeight();
  int screenWidth=windowManager.getDefaultDisplay().getWidth();
  int xPos=((screenWidth - rootWidth) / 2) + xOffset;
  int yPos=anchorRect.top - rootHeight + yOffset;
  if (rootHeight > anchorRect.top) {
    yPos=anchorRect.bottom + yOffset;
    window.setAnimationStyle(R.style.Animations_PopDownMenu_Center);
  }
  window.showAtLocation(anchor,Gravity.NO_GRAVITY,xPos,yPos);
}
