{
  if (mAvailablePlans == null || mAvailablePlans.length == 0) {
    Toast.makeText(PlansActivity.this,R.string.plans_loading_error,Toast.LENGTH_LONG).show();
    finish();
    return;
  }
  final ProgressBar progress=(ProgressBar)findViewById(R.id.progress_loading_plans);
  progress.setVisibility(View.GONE);
  mViewPager.setVisibility(View.VISIBLE);
  mViewPager.setOffscreenPageLimit(mAvailablePlans.length - 1);
  mViewPager.setAdapter(getPageAdapter());
  mTabLayout.setVisibility(View.VISIBLE);
  mTabLayout.setTabMode(TabLayout.MODE_FIXED);
  int normalColor=getResources().getColor(R.color.blue_light);
  int selectedColor=getResources().getColor(R.color.white);
  mTabLayout.setTabTextColors(normalColor,selectedColor);
  mTabLayout.setupWithViewPager(mViewPager);
  if (mViewpagerPosSelected == NO_PREV_POS_SELECTED_VIEWPAGER) {
    for (    SitePlan currentSitePlan : mAvailablePlans) {
      if (currentSitePlan.isCurrentPlan()) {
        mViewpagerPosSelected=getPageAdapter().getPositionOfPlan(currentSitePlan.getProductID());
      }
    }
  }
  if (getPageAdapter().isValidPosition(mViewpagerPosSelected)) {
    mViewPager.setCurrentItem(mViewpagerPosSelected);
  }
}
