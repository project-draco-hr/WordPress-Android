{
  super.onCreate(savedInstanceState);
  PreferenceManager.getDefaultSharedPreferences(getActivity()).edit().remove(getString(R.string.pref_key_site_language)).commit();
  addPreferencesFromResource(R.xml.site_settings);
  Integer id=getArguments().getInt(BlogPreferencesActivity.ARG_LOCAL_BLOG_ID,-1);
  mBlog=WordPress.getBlog(id);
  if (mBlog == null)   return;
  initPreferences();
  WordPress.getRestClientUtils().getGeneralSettings(String.valueOf(mBlog.getRemoteBlogId()),new RestRequest.Listener(){
    @Override public void onResponse(    JSONObject response){
      if (mTitlePreference != null) {
        mTitlePreference.setText(response.optString(RestClientUtils.SITE_TITLE_KEY));
        mTitlePreference.setSummary(response.optString(RestClientUtils.SITE_TITLE_KEY));
      }
      if (mTaglinePreference != null) {
        mTaglinePreference.setText(response.optString(RestClientUtils.SITE_DESC_KEY));
        mTaglinePreference.setSummary(response.optString(RestClientUtils.SITE_DESC_KEY));
      }
      if (mAddressPreference != null) {
        mAddressPreference.setText(response.optString(RestClientUtils.SITE_URL_KEY));
        mAddressPreference.setSummary(response.optString(RestClientUtils.SITE_URL_KEY));
        mAddressPreference.setEnabled(false);
      }
      if (mLanguagePreference != null) {
        String languageString=getLanguageString(response.optString(RestClientUtils.SITE_LANGUAGE_KEY));
        mLanguagePreference.setDefaultValue(languageString);
        mLanguagePreference.setSummary(languageString);
      }
      if (mVisibilityPreference != null) {
        int visibility=response.optJSONObject("settings").optInt("blog_public");
        mVisibilityPreference.setValue(String.valueOf(visibility));
      }
    }
  }
,new RestRequest.ErrorListener(){
    @Override public void onErrorResponse(    VolleyError error){
      if (isAdded()) {
        ToastUtils.showToast(getActivity(),"Error getting site info");
      }
    }
  }
);
  setHasOptionsMenu(true);
}
