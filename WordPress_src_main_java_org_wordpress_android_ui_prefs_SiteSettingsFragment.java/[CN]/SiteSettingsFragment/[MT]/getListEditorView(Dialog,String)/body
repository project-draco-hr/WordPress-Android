{
  Context themer=new ContextThemeWrapper(getActivity(),R.style.Calypso_SiteSettingsTheme);
  View view=View.inflate(themer,R.layout.list_editor,null);
  ((TextView)view.findViewById(R.id.list_editor_footer_text)).setText(footerText);
  final MultiSelectListView list=(MultiSelectListView)view.findViewById(android.R.id.list);
  final MultiSelectListViewAdapter adapter=new MultiSelectListViewAdapter(getActivity(),mEditingList);
  list.setEnterMultiSelectListener(new MultiSelectListView.OnEnterMultiSelect(){
    @Override public void onEnterMultiSelect(){
      WPActivityUtils.setStatusBarColor(dialog.getWindow(),R.color.action_mode_status_bar_tint);
    }
  }
);
  list.setExitMultiSelectListener(new MultiSelectListView.OnExitMultiSelect(){
    @Override public void onExitMultiSelect(){
      WPActivityUtils.setStatusBarColor(dialog.getWindow(),R.color.status_bar_tint);
    }
  }
);
  list.setDeleteRequestListener(new MultiSelectListView.OnDeleteRequested(){
    @Override public boolean onDeleteRequested(){
      SparseBooleanArray checkedItems=list.getCheckedItemPositions();
      HashMap<String,Object> properties=new HashMap<>();
      properties.put("num_items_deleted",checkedItems.size());
      AnalyticsUtils.trackWithCurrentBlogDetails(AnalyticsTracker.Stat.SITE_SETTINGS_DELETED_LIST_ITEMS,properties);
      List<String> itemsToRemove=new ArrayList<>();
      for (int i=0; i < adapter.getCount(); i++) {
        final int index=checkedItems.keyAt(i);
        if (checkedItems.get(index)) {
          itemsToRemove.add(adapter.getItem(index));
        }
      }
      mEditingList.removeAll(itemsToRemove);
      list.setAdapter(new MultiSelectListViewAdapter(getActivity(),mEditingList));
      mSiteSettings.saveSettings();
      return true;
    }
  }
);
  list.setEmptyView(view.findViewById(R.id.empty_view));
  list.setChoiceMode(AbsListView.CHOICE_MODE_MULTIPLE);
  list.setAdapter(new MultiSelectListViewAdapter(getActivity(),mEditingList));
  view.findViewById(R.id.fab_button).setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      AlertDialog.Builder builder=new AlertDialog.Builder(getActivity(),R.style.Calypso_AlertDialog);
      final EditText input=new EditText(getActivity());
      WPPrefUtils.layoutAsInput(input);
      input.setWidth(getResources().getDimensionPixelSize(R.dimen.list_editor_input_max_width));
      input.setHint(R.string.site_settings_list_editor_input_hint);
      builder.setPositiveButton(R.string.ok,new DialogInterface.OnClickListener(){
        @Override public void onClick(        DialogInterface dialog,        int which){
          String entry=input.getText().toString();
          if (!TextUtils.isEmpty(entry) && !mEditingList.contains(entry)) {
            mEditingList.add(entry);
            list.setAdapter(new MultiSelectListViewAdapter(getActivity(),mEditingList));
            mSiteSettings.saveSettings();
            AnalyticsUtils.trackWithCurrentBlogDetails(AnalyticsTracker.Stat.SITE_SETTINGS_ADDED_LIST_ITEM);
          }
        }
      }
);
      builder.setNegativeButton(R.string.cancel,null);
      final AlertDialog alertDialog=builder.create();
      int spacing=getResources().getDimensionPixelSize(R.dimen.dlp_padding_start);
      alertDialog.setView(input,spacing,spacing,spacing,0);
      alertDialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
      alertDialog.getWindow().setSoftInputMode(LayoutParams.SOFT_INPUT_STATE_VISIBLE);
      alertDialog.setOnDismissListener(new DialogInterface.OnDismissListener(){
        @Override public void onDismiss(        DialogInterface dialog){
          alertDialog.getWindow().setSoftInputMode(LayoutParams.SOFT_INPUT_STATE_HIDDEN);
        }
      }
);
      alertDialog.show();
      Button positive=alertDialog.getButton(DialogInterface.BUTTON_POSITIVE);
      Button negative=alertDialog.getButton(DialogInterface.BUTTON_NEGATIVE);
      if (positive != null)       WPPrefUtils.layoutAsFlatButton(positive);
      if (negative != null)       WPPrefUtils.layoutAsFlatButton(negative);
    }
  }
);
  return view;
}
