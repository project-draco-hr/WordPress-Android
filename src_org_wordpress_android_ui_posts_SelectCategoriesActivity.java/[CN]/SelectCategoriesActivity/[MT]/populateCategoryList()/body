{
  mCategoryLevels=CategoryNode.getSortedListOfCategoriesFromRoot(mCategories);
  for (int i=0; i < mCategoryLevels.size(); i++) {
    mCategoryNames.put(mCategoryLevels.get(i).getName(),i);
  }
  CategoryArrayAdapter categoryAdapter=new CategoryArrayAdapter(this,R.layout.categories_row,mCategoryLevels);
  this.setListAdapter(categoryAdapter);
  if (mSelectedCategories != null) {
    ListView lv=getListView();
    for (    String selectedCategory : mSelectedCategories) {
      if (mCategoryNames.keySet().contains(selectedCategory)) {
        lv.setItemChecked(mCategoryNames.get(selectedCategory),true);
      }
    }
  }
  restoreScrollOffset();
}
