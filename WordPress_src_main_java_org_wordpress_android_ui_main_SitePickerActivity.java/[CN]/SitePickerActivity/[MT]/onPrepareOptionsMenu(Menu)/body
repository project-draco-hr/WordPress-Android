{
  super.onPrepareOptionsMenu(menu);
  int numSites=WordPress.wpDB.getNumDotComBlogs();
  mMenuEdit=menu.findItem(R.id.menu_edit);
  if (getAdapter().getIsInSearchMode()) {
    mMenuEdit.setVisible(false);
  }
 else {
    mMenuEdit.setVisible(numSites > 1);
  }
  MenuItem menuSearch=menu.findItem(R.id.menu_search);
  mSearchView.setIconifiedByDefault(false);
  mSearchView.setOnQueryTextListener(this);
  MenuItemCompat.setOnActionExpandListener(menuSearch,new MenuItemCompat.OnActionExpandListener(){
    @Override public boolean onMenuItemActionExpand(    MenuItem item){
      enableSearchMode();
      return true;
    }
    @Override public boolean onMenuItemActionCollapse(    MenuItem item){
      disableSearchMode();
      return true;
    }
  }
);
  if (getAdapter().getIsInSearchMode()) {
    menuSearch.expandActionView();
    mSearchView.setQuery(getAdapter().getLastSearch(),false);
  }
  return true;
}
