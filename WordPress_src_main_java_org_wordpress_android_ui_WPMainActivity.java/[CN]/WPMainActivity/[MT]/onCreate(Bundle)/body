{
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_main);
  Toolbar toolbar=(Toolbar)findViewById(R.id.toolbar);
  setSupportActionBar(toolbar);
  mViewPager=(WPMainViewPager)findViewById(R.id.viewpager_main);
  mTabAdapter=new WPMainTabAdapter(getFragmentManager());
  mViewPager.setAdapter(mTabAdapter);
  mTabs=(SlidingTabLayout)findViewById(R.id.sliding_tabs);
  mTabs.setCustomTabView(R.layout.tab_text,R.id.text_tab);
  mTabs.setSelectedIndicatorColors(getResources().getColor(R.color.tab_indicator));
  mTabs.setDistributeEvenly(true);
  mTabs.setViewPager(mViewPager);
  if (savedInstanceState == null) {
    int position=AppPrefs.getMainTabIndex();
    if (mTabAdapter.isValidPosition(position) && position != mViewPager.getCurrentItem()) {
      mViewPager.setCurrentItem(position);
    }
  }
  mTabs.setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener(){
    @Override public void onPageSelected(    int position){
      AppPrefs.setMainTabIndex(position);
    }
  }
);
}
