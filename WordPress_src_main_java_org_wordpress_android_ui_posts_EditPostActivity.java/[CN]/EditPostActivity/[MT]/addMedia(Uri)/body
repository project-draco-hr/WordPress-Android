{
  if (imageUri != null && !MediaUtils.isInMediaStore(imageUri) && !imageUri.toString().startsWith("/")) {
    imageUri=MediaUtils.downloadExternalMedia(this,imageUri);
  }
  if (imageUri == null) {
    return false;
  }
  String mediaTitle;
  if (MediaUtils.isVideo(imageUri.toString())) {
    mediaTitle=getResources().getString(R.string.video);
  }
 else {
    mediaTitle=ImageUtils.getTitleForWPImageSpan(this,imageUri.getEncodedPath());
  }
  MediaFile mediaFile=new MediaFile();
  mediaFile.setPostID(getPost().getLocalTablePostId());
  mediaFile.setTitle(mediaTitle);
  mediaFile.setFilePath(imageUri.toString());
  if (imageUri.getEncodedPath() != null) {
    mediaFile.setVideo(MediaUtils.isVideo(imageUri.toString()));
  }
  WordPress.wpDB.saveMediaFile(mediaFile);
  mEditorFragment.appendMediaFile(mediaFile,mediaFile.getFilePath(),WordPress.imageLoader);
  return true;
}
