{
  int itemId=item.getItemId();
  if (itemId == android.R.id.home) {
    Fragment fragment=getFragmentManager().findFragmentByTag(ImageSettingsDialogFragment.IMAGE_SETTINGS_DIALOG_TAG);
    if (fragment != null && fragment.isVisible()) {
      return false;
    }
    if (mViewPager.getCurrentItem() > PAGE_CONTENT) {
      if (mViewPager.getCurrentItem() == PAGE_SETTINGS) {
        mPost.setFeaturedImageId(mEditPostSettingsFragment.getFeaturedImageId());
        mEditorFragment.setFeaturedImageId(mPost.getFeaturedImageId());
      }
      mViewPager.setCurrentItem(PAGE_CONTENT);
      invalidateOptionsMenu();
    }
 else {
      saveAndFinish();
    }
    return true;
  }
  MediaUploadService mediaUploadService=MediaUploadService.getInstance();
  if ((mediaUploadService != null && mediaUploadService.hasUploads()) || mEditorFragment.isUploadingMedia()) {
    ToastUtils.showToast(this,R.string.editor_toast_uploading_please_wait,Duration.SHORT);
    return false;
  }
  if (mEditorFragment.hasFailedMediaUploads()) {
    AlertDialog.Builder builder=new AlertDialog.Builder(this);
    builder.setMessage(R.string.editor_toast_failed_uploads).setPositiveButton(R.string.editor_remove_failed_uploads,new DialogInterface.OnClickListener(){
      public void onClick(      DialogInterface dialog,      int id){
        mEditorFragment.removeAllFailedMediaUploads();
      }
    }
).setNegativeButton(android.R.string.cancel,null);
    builder.create().show();
    return true;
  }
  if (itemId == R.id.menu_save_post) {
    return savePost();
  }
 else   if (itemId == R.id.menu_preview_post) {
    mViewPager.setCurrentItem(PAGE_PREVIEW);
  }
 else   if (itemId == R.id.menu_post_settings) {
    InputMethodManager imm=((InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE));
    imm.hideSoftInputFromWindow(getWindow().getDecorView().getWindowToken(),0);
    if (mShowNewEditor) {
      mEditPostSettingsFragment.updateFeaturedImage(mPost.getFeaturedImageId());
    }
    mViewPager.setCurrentItem(PAGE_SETTINGS);
  }
  return false;
}
