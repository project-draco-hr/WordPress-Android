{
  super.onCreate(icicle);
  overridePendingTransition(R.anim.slide_up,R.anim.do_nothing);
  setTitle(getResources().getText(R.string.settings));
  ActionBar ab=getSupportActionBar();
  ab.setDisplayHomeAsUpEnabled(true);
  addPreferencesFromResource(R.xml.preferences);
  mNotificationsGroup=(PreferenceGroup)findPreference("wp_pref_notifications_category");
  OnPreferenceChangeListener preferenceChangeListener=new OnPreferenceChangeListener(){
    @Override public boolean onPreferenceChange(    Preference preference,    Object newValue){
      if (newValue != null) {
        preference.setSummary(newValue.toString());
      }
      InputMethodManager imm=(InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
      imm.hideSoftInputFromWindow(getListView().getWindowToken(),0);
      return true;
    }
  }
;
  mTaglineTextPreference=(WPEditTextPreference)findPreference("wp_pref_post_signature");
  if (mTaglineTextPreference != null) {
    mTaglineTextPreference.setOnPreferenceChangeListener(preferenceChangeListener);
  }
  Preference signOutPreference=findPreference("wp_pref_sign_out");
  signOutPreference.setOnPreferenceClickListener(signOutPreferenceClickListener);
  Preference resetAutoShare=findPreference("wp_reset_share_pref");
  resetAutoShare.setOnPreferenceClickListener(resetAUtoSharePreferenceClickListener);
  mSettings=PreferenceManager.getDefaultSharedPreferences(this);
  if (WordPress.hasValidWPComCredentials(PreferencesActivity.this)) {
    String settingsJson=mSettings.getString(NotificationUtils.WPCOM_PUSH_DEVICE_NOTIFICATION_SETTINGS,null);
    if (settingsJson == null) {
      com.wordpress.rest.RestRequest.Listener listener=new RestRequest.Listener(){
        @Override public void onResponse(        JSONObject jsonObject){
          AppLog.d(T.NOTIFS,"Get settings action succeeded");
          Editor editor=mSettings.edit();
          try {
            JSONObject settingsJSON=jsonObject.getJSONObject("settings");
            editor.putString(NotificationUtils.WPCOM_PUSH_DEVICE_NOTIFICATION_SETTINGS,settingsJSON.toString());
            editor.commit();
          }
 catch (          JSONException e) {
            AppLog.e(T.NOTIFS,"Can't parse the JSON object returned from the server that contains PN settings.",e);
          }
          refreshWPComAuthCategory();
        }
      }
;
      RestRequest.ErrorListener errorListener=new RestRequest.ErrorListener(){
        @Override public void onErrorResponse(        VolleyError volleyError){
          AppLog.e(T.NOTIFS,"Get settings action failed",volleyError);
        }
      }
;
      NotificationUtils.getPushNotificationSettings(PreferencesActivity.this,listener,errorListener);
    }
  }
  if (AppLockManager.getInstance().isAppLockFeatureEnabled() == false) {
    PreferenceScreen rootScreen=(PreferenceScreen)findPreference("wp_pref_root");
    PreferenceGroup passcodeGroup=(PreferenceGroup)findPreference("wp_passcode_lock_category");
    rootScreen.removePreference(passcodeGroup);
  }
 else {
    final CheckBoxPreference passcodeEnabledCheckBoxPreference=(CheckBoxPreference)findPreference("wp_pref_passlock_enabled");
    passcodeEnabledCheckBoxPreference.setOnPreferenceClickListener(new OnPreferenceClickListener(){
      @Override public boolean onPreferenceClick(      Preference preference){
        passcodeEnabledCheckBoxPreference.setChecked(AppLockManager.getInstance().getCurrentAppLock().isPasswordLocked());
        return false;
      }
    }
);
  }
  displayPreferences();
}
