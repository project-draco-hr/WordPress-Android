{
  PreferenceCategory blogsCategory=(PreferenceCategory)findPreference("wp_pref_category_blogs");
  blogsCategory.removeAll();
  List<Map<String,Object>> accounts=WordPress.wpDB.getShownAccounts();
  int order=0;
  for (  Map<String,Object> account : accounts) {
    String blogName=StringUtils.unescapeHTML(account.get("blogName").toString());
    int accountId=(Integer)account.get("id");
    Preference blogSettingsPreference=new Preference(this);
    blogSettingsPreference.setTitle(blogName);
    try {
      URL blogUrl=new URL(account.get("url").toString());
      if (!blogName.equals(blogUrl.getHost())) {
        blogSettingsPreference.setSummary(blogUrl.getHost());
      }
    }
 catch (    MalformedURLException e) {
    }
    Intent intent=new Intent(this,BlogPreferencesActivity.class);
    intent.putExtra("id",accountId);
    blogSettingsPreference.setIntent(intent);
    blogSettingsPreference.setOrder(order++);
    blogsCategory.addPreference(blogSettingsPreference);
  }
  Preference addBlogPreference=new Preference(this);
  addBlogPreference.setTitle(R.string.add_blog);
  Intent intent=new Intent(this,WelcomeActivity.class);
  addBlogPreference.setIntent(intent);
  addBlogPreference.setOrder(order++);
  blogsCategory.addPreference(addBlogPreference);
  List<Map<String,Object>> allAccounts=WordPress.wpDB.getAllAccounts();
  if (allAccounts.size() > 1) {
    Preference manageBlogPreference=new Preference(this);
    manageBlogPreference.setTitle(R.string.show_and_hide_blogs);
    intent=new Intent(this,ManageBlogsActivity.class);
    manageBlogPreference.setIntent(intent);
    manageBlogPreference.setOrder(order++);
    blogsCategory.addPreference(manageBlogPreference);
  }
}
