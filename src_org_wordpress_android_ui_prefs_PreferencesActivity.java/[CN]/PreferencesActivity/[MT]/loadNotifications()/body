{
  AppLog.d(T.NOTIFS,"Preferences > loading notification settings");
  PreferenceScreen rootScreen=(PreferenceScreen)findPreference("wp_pref_root");
  rootScreen.addPreference(mNotificationsGroup);
  PreferenceCategory notificationTypesCategory=(PreferenceCategory)findPreference("wp_pref_notification_types");
  notificationTypesCategory.removeAll();
  SharedPreferences settings=PreferenceManager.getDefaultSharedPreferences(this);
  String settingsJson=settings.getString(NotificationUtils.WPCOM_PUSH_DEVICE_NOTIFICATION_SETTINGS,null);
  if (settingsJson == null) {
    rootScreen.removePreference(mNotificationsGroup);
    return;
  }
 else {
    try {
      Gson gson=new Gson();
      mNotificationSettings=gson.fromJson(settingsJson,HashMap.class);
      StringMap<?> mutedBlogsMap=(StringMap<?>)mNotificationSettings.get("muted_blogs");
      mMutedBlogsList=(ArrayList<StringMap<Double>>)mutedBlogsMap.get("value");
      Collections.sort(mMutedBlogsList,this.BlogNameComparatorForMutedBlogsList);
      Object[] mTypeList=mNotificationSettings.keySet().toArray();
      for (int i=0; i < mTypeList.length; i++) {
        if (!mTypeList[i].equals("muted_blogs") && !mTypeList[i].equals("mute_until")) {
          StringMap<?> typeMap=(StringMap<?>)mNotificationSettings.get(mTypeList[i].toString());
          CheckBoxPreference typePreference=new CheckBoxPreference(this);
          typePreference.setKey(mTypeList[i].toString());
          typePreference.setChecked(MapUtils.getMapBool(typeMap,"value"));
          typePreference.setTitle(typeMap.get("desc").toString());
          typePreference.setOnPreferenceChangeListener(mTypeChangeListener);
          notificationTypesCategory.addPreference(typePreference);
        }
      }
      PreferenceCategory selectBlogsCategory=(PreferenceCategory)findPreference("wp_pref_notification_blogs");
      selectBlogsCategory.removeAll();
      for (int i=0; i < mMutedBlogsList.size(); i++) {
        StringMap<?> blogMap=(StringMap<?>)mMutedBlogsList.get(i);
        String blogName=(String)blogMap.get("blog_name");
        if (blogName == null || blogName.trim().equals(""))         blogName=(String)blogMap.get("url");
        CheckBoxPreference blogPreference=new CheckBoxPreference(this);
        blogPreference.setChecked(!MapUtils.getMapBool(blogMap,"value"));
        blogPreference.setTitle(StringUtils.unescapeHTML(blogName));
        blogPreference.setOnPreferenceChangeListener(mMuteBlogChangeListener);
        blogPreference.setOrder(i);
        selectBlogsCategory.addPreference(blogPreference);
      }
    }
 catch (    JsonSyntaxException e) {
      AppLog.v(T.NOTIFS,"Notification Settings Json could not be parsed.");
      return;
    }
catch (    Exception e) {
      AppLog.v(T.NOTIFS,"Failed to load notification settings.");
      return;
    }
    CheckBoxPreference notificationsEnabledCheckBox=(CheckBoxPreference)findPreference("wp_pref_notifications_enabled");
    notificationsEnabledCheckBox.setOnPreferenceChangeListener(mNotificationsEnabledChangeListener);
  }
}
