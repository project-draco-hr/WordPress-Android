{
  String sort=NAME + "." + Columns.TOTAL+ " DESC, "+ NAME+ "."+ Columns.NAME+ " ASC LIMIT "+ StatsActivity.STATS_GROUP_MAX_ITEMS;
  String timeframe=uri.getQueryParameter("timeframe");
  if (timeframe == null)   return super.query(database,uri,projection,selection,selectionArgs,sort);
  if (timeframe.equals(StatsTimeframe.TODAY.name())) {
    return database.rawQuery("SELECT * FROM " + NAME + ", "+ "(SELECT MAX(date) AS date FROM "+ NAME+ ") AS temp "+ "WHERE temp.date = "+ NAME+ ".date AND "+ selection+ " ORDER BY "+ sort,selectionArgs);
  }
 else   if (timeframe.equals(StatsTimeframe.YESTERDAY.name())) {
    return database.rawQuery("SELECT * FROM " + NAME + ", "+ "(SELECT MAX(date) AS date FROM "+ NAME+ ", "+ "( SELECT MAX(date) AS max FROM "+ NAME+ ")"+ " WHERE "+ NAME+ ".date < max) AS temp "+ "WHERE "+ NAME+ ".date = temp.date AND "+ selection+ " ORDER BY "+ sort,selectionArgs);
  }
  return super.query(database,uri,projection,selection,selectionArgs,sort);
}
