{
  super.onCreate(savedInstanceState);
  setContentView(R.layout.posts);
  FragmentManager fm=getSupportFragmentManager();
  postList=(ViewPosts)fm.findFragmentById(R.id.postList);
  Bundle extras=getIntent().getExtras();
  if (extras != null) {
    isPage=extras.getBoolean("viewPages");
  }
  WordPress.currentPost=null;
  titleBar=(WPTitleBar)findViewById(R.id.postsActionBar);
  titleBar.refreshButton.setOnClickListener(new ImageButton.OnClickListener(){
    public void onClick(    View v){
      postList.refreshPosts(false);
    }
  }
);
  titleBar.setOnBlogChangedListener(new OnBlogChangedListener(){
    @Override public void OnBlogChanged(){
      FragmentManager fm=getSupportFragmentManager();
      ViewPostFragment f=(ViewPostFragment)fm.findFragmentById(R.id.postDetail);
      if (f == null) {
        fm.popBackStack();
      }
      attemptToSelectPost();
      boolean loadedPosts=postList.loadPosts(false);
      if (!loadedPosts)       postList.refreshPosts(false);
    }
  }
);
  attemptToSelectPost();
}
