{
  if (postList.getPostsTask != null) {
    postList.getPostsTask.cancel(true);
    titleBar.stopRotatingRefreshIcon();
    isRefreshing=false;
  }
  if (action == POST_DELETE) {
    if (post.isLocalDraft()) {
      AlertDialog.Builder dialogBuilder=new AlertDialog.Builder(Posts.this);
      dialogBuilder.setTitle(getResources().getText(R.string.delete_draft));
      dialogBuilder.setMessage(getResources().getText(R.string.delete_sure) + " '" + post.getTitle()+ "'?");
      dialogBuilder.setPositiveButton(getResources().getText(R.string.yes),new DialogInterface.OnClickListener(){
        public void onClick(        DialogInterface dialog,        int whichButton){
          post.delete();
          attemptToSelectPost();
          postList.loadPosts(false);
        }
      }
);
      dialogBuilder.setNegativeButton(getResources().getText(R.string.no),new DialogInterface.OnClickListener(){
        public void onClick(        DialogInterface dialog,        int whichButton){
        }
      }
);
      dialogBuilder.setCancelable(true);
      if (!isFinishing()) {
        dialogBuilder.create().show();
      }
    }
 else {
      AlertDialog.Builder dialogBuilder=new AlertDialog.Builder(Posts.this);
      dialogBuilder.setTitle(getResources().getText((post.isPage()) ? R.string.delete_page : R.string.delete_post));
      dialogBuilder.setMessage(getResources().getText((post.isPage()) ? R.string.delete_sure_page : R.string.delete_sure_post) + " '" + post.getTitle()+ "'?");
      dialogBuilder.setPositiveButton(getResources().getText(R.string.yes),new DialogInterface.OnClickListener(){
        public void onClick(        DialogInterface dialog,        int whichButton){
          new Posts.deletePostTask().execute(post);
        }
      }
);
      dialogBuilder.setNegativeButton(getResources().getText(R.string.no),new DialogInterface.OnClickListener(){
        public void onClick(        DialogInterface dialog,        int whichButton){
        }
      }
);
      dialogBuilder.setCancelable(true);
      if (!isFinishing()) {
        dialogBuilder.create().show();
      }
    }
  }
 else   if (action == POST_SHARE) {
    new Posts.shareURLTask().execute(post);
  }
 else   if (action == POST_CLEAR) {
    FragmentManager fm=getSupportFragmentManager();
    ViewPostFragment f=(ViewPostFragment)fm.findFragmentById(R.id.postDetail);
    if (f != null) {
      f.clearContent();
    }
  }
}
