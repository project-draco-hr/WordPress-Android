{
  if (filePath == null)   return null;
  Uri curStream=null;
  String title="";
  if (filePath != null) {
    if (!filePath.contains("content://"))     curStream=Uri.parse("content://media" + filePath);
 else     curStream=Uri.parse(filePath);
  }
  if (curStream == null) {
    return null;
  }
  if (filePath.contains("video")) {
    return "Video";
  }
 else {
    String[] projection=new String[]{Images.Thumbnails.DATA};
    String path="";
    Cursor cur;
    try {
      cur=ctx.getContentResolver().query(curStream,projection,null,null,null);
    }
 catch (    Exception e1) {
      return null;
    }
    File jpeg=null;
    if (cur != null) {
      String thumbData="";
      if (cur.moveToFirst()) {
        int dataColumn=cur.getColumnIndex(Images.Media.DATA);
        thumbData=cur.getString(dataColumn);
      }
      cur.close();
      if (thumbData == null) {
        return null;
      }
      jpeg=new File(thumbData);
      path=thumbData;
    }
 else {
      path=filePath.toString().replace("file://","");
      jpeg=new File(path);
    }
    title=jpeg.getName();
    return title;
  }
}
