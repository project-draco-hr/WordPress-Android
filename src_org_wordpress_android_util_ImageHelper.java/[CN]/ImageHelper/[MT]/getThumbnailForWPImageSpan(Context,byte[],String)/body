{
  Display display=((Activity)ctx).getWindowManager().getDefaultDisplay();
  int width=display.getWidth();
  int height=display.getHeight();
  if (width > height)   width=height;
  BitmapFactory.Options opts=new BitmapFactory.Options();
  opts.inJustDecodeBounds=true;
  BitmapFactory.decodeByteArray(bytes,0,bytes.length,opts);
  float conversionFactor=0.40f;
  if (opts.outWidth > opts.outHeight)   conversionFactor=0.70f;
  byte[] finalBytes=createThumbnail(bytes,String.valueOf((int)(width * conversionFactor)),orientation,true);
  if (finalBytes == null) {
    return null;
  }
  return BitmapFactory.decodeByteArray(finalBytes,0,finalBytes.length);
}
