{
  if (note == null)   return;
  FragmentManager fm=getSupportFragmentManager();
  if (fm.getBackStackEntryCount() > 0) {
    fm.popBackStack();
  }
  Fragment fragment=fragmentForNote(note);
  if (fragment == null) {
    Log.d(TAG,String.format("No fragment found for %s",note.toJSONObject()));
    return;
  }
  NotificationFragment noteFragment=(NotificationFragment)fragment;
  noteFragment.setNote(note);
  FragmentTransaction transaction=fm.beginTransaction();
  View container=findViewById(R.id.note_fragment_container);
  transaction.replace(R.id.note_fragment_container,fragment);
  transaction.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
  if (container.findViewById(R.id.notes_list) != null) {
    transaction.addToBackStack(null);
  }
  transaction.commit();
}
