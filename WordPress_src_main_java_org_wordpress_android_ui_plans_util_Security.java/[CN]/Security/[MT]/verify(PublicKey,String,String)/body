{
  byte[] signatureBytes;
  try {
    signatureBytes=Base64.decode(signature,Base64.DEFAULT);
  }
 catch (  IllegalArgumentException e) {
    Log.e(TAG,"Base64 decoding failed.");
    return false;
  }
  try {
    Signature sig=Signature.getInstance(SIGNATURE_ALGORITHM);
    sig.initVerify(publicKey);
    sig.update(signedData.getBytes());
    if (!sig.verify(signatureBytes)) {
      Log.e(TAG,"Signature verification failed.");
      return false;
    }
    return true;
  }
 catch (  NoSuchAlgorithmException e) {
    Log.e(TAG,"NoSuchAlgorithmException.");
  }
catch (  InvalidKeyException e) {
    Log.e(TAG,"Invalid key specification.");
  }
catch (  SignatureException e) {
    Log.e(TAG,"Signature exception.");
  }
  return false;
}
