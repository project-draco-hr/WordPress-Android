{
  SharedPreferences sharedPreferences=PreferenceManager.getDefaultSharedPreferences(context);
  if (sharedPreferences.contains(SettingsFragment.LANGUAGE_PREF_KEY)) {
    Locale contextLocale=context.getResources().getConfiguration().locale;
    String contextLanguage=contextLocale.getLanguage();
    String contextCountry=contextLocale.getCountry();
    String locale=sharedPreferences.getString(SettingsFragment.LANGUAGE_PREF_KEY,"");
    if (!TextUtils.isEmpty(contextCountry)) {
      contextLanguage+="-" + contextCountry;
    }
    if (!locale.equals(contextLanguage)) {
      Resources resources=context.getResources();
      Configuration conf=resources.getConfiguration();
      conf.locale=new Locale(locale);
      resources.updateConfiguration(conf,resources.getDisplayMetrics());
      if (restart) {
        Intent refresh=context.getIntent();
        if (refresh == null) {
          refresh=new Intent(context,context.getClass());
        }
        refresh.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
        context.startActivity(refresh);
        context.finish();
        context.overridePendingTransition(0,0);
      }
    }
  }
}
