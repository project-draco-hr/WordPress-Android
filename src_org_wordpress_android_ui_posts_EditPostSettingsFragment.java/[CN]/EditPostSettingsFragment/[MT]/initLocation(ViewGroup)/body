{
  boolean hasLocationProvider=false;
  LocationManager locationManager=(LocationManager)getActivity().getSystemService(Activity.LOCATION_SERVICE);
  List<String> providers=locationManager.getProviders(true);
  if (providers != null) {
    for (    String providerName : providers) {
      if (providerName.equals(LocationManager.GPS_PROVIDER) || providerName.equals(LocationManager.NETWORK_PROVIDER)) {
        hasLocationProvider=true;
      }
    }
  }
  if (hasLocationProvider && WordPress.getCurrentBlog().isLocation() && mActivity.getPost().supportsLocation()) {
    View locationRootView=((ViewStub)rootView.findViewById(R.id.stub_post_location_settings)).inflate();
    ((TextView)locationRootView.findViewById(R.id.locationLabel)).setText(getResources().getString(R.string.location).toUpperCase());
    mLocationText=(TextView)locationRootView.findViewById(R.id.locationText);
    Button viewMap=(Button)locationRootView.findViewById(R.id.viewMap);
    Button updateLocation=(Button)locationRootView.findViewById(R.id.updateLocation);
    Button removeLocation=(Button)locationRootView.findViewById(R.id.removeLocation);
    updateLocation.setOnClickListener(this);
    removeLocation.setOnClickListener(this);
    viewMap.setOnClickListener(this);
    if (!mActivity.getPost().hasLocation()) {
      getLocation();
    }
  }
}
