{
  setStatusBarColor();
  super.onCreate(savedInstanceState);
  setContentView(R.layout.main_activity);
  mViewPager=(WPMainViewPager)findViewById(R.id.viewpager_main);
  mTabAdapter=new WPMainTabAdapter(getFragmentManager());
  mViewPager.setAdapter(mTabAdapter);
  mTabLayout=(WPMainTabLayout)findViewById(R.id.tab_layout);
  mTabLayout.createTabs();
  mTabLayout.setOnTabSelectedListener(new TabLayout.OnTabSelectedListener(){
    @Override public void onTabSelected(    TabLayout.Tab tab){
      mViewPager.setCurrentItem(tab.getPosition());
    }
    @Override public void onTabUnselected(    TabLayout.Tab tab){
    }
    @Override public void onTabReselected(    TabLayout.Tab tab){
      Fragment fragment=mTabAdapter.getFragment(tab.getPosition());
      if (fragment instanceof OnScrollToTopListener) {
        ((OnScrollToTopListener)fragment).onScrollToTop();
      }
    }
  }
);
  mViewPager.addOnPageChangeListener(new TabLayout.TabLayoutOnPageChangeListener(mTabLayout));
  mViewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener(){
    @Override public void onPageSelected(    int position){
      AppPrefs.setMainTabIndex(position);
switch (position) {
case WPMainTabAdapter.TAB_NOTIFS:
        if (getNotificationListFragment() != null) {
          getNotificationListFragment().updateLastSeenTime();
          mTabLayout.showNoteBadge(false);
        }
      break;
  }
}
@Override public void onPageScrollStateChanged(int state){
}
@Override public void onPageScrolled(int position,float positionOffset,int positionOffsetPixels){
  if (position == WPMainTabAdapter.TAB_MY_SITE) {
    EventBus.getDefault().post(new MainViewPagerScrolled(positionOffset));
  }
}
}
);
if (savedInstanceState == null) {
if (AccountHelper.isSignedIn()) {
  boolean openedFromPush=(getIntent() != null && getIntent().getBooleanExtra(ARG_OPENED_FROM_PUSH,false));
  if (openedFromPush) {
    getIntent().putExtra(ARG_OPENED_FROM_PUSH,false);
    launchWithNoteId();
  }
 else {
    int position=AppPrefs.getMainTabIndex();
    if (mTabAdapter.isValidPosition(position) && position != mViewPager.getCurrentItem()) {
      mViewPager.setCurrentItem(position);
    }
  }
}
 else {
  ActivityLauncher.showSignInForResult(this);
}
}
}
