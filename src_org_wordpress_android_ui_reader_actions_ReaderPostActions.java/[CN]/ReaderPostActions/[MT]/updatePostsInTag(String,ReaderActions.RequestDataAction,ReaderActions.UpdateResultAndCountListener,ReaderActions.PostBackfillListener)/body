{
  final ReaderTag topic=ReaderTagTable.getTag(tagName);
  if (topic == null) {
    if (resultListener != null)     resultListener.onUpdateResult(ReaderActions.UpdateResult.FAILED,-1);
    return;
  }
  StringBuilder sb=new StringBuilder(topic.getEndpoint());
  sb.append("?number=").append(ReaderConstants.READER_MAX_POSTS_TO_REQUEST);
  sb.append("&order=DESC");
  if (ReaderPostTable.hasPostsWithTag(tagName)) {
switch (updateAction) {
case LOAD_NEWER:
      String dateNewest=ReaderTagTable.getTagNewestDate(tagName);
    if (!TextUtils.isEmpty(dateNewest)) {
      sb.append("&after=").append(UrlUtils.urlEncode(dateNewest));
      AppLog.d(T.READER,String.format("requesting newer posts in topic %s (%s)",tagName,dateNewest));
    }
  break;
case LOAD_OLDER:
String dateOldest=ReaderTagTable.getTagOldestDate(tagName);
if (TextUtils.isEmpty(dateOldest)) dateOldest=ReaderPostTable.getOldestPubDateWithTag(tagName);
if (!TextUtils.isEmpty(dateOldest)) {
sb.append("&before=").append(UrlUtils.urlEncode(dateOldest));
AppLog.d(T.READER,String.format("requesting older posts in topic %s (%s)",tagName,dateOldest));
}
break;
}
}
 else {
AppLog.d(T.READER,String.format("requesting posts in empty topic %s",tagName));
}
String endpoint=sb.toString();
com.wordpress.rest.RestRequest.Listener listener=new RestRequest.Listener(){
@Override public void onResponse(JSONObject jsonObject){
handleUpdatePostsWithTagResponse(tagName,updateAction,jsonObject,resultListener,backfillListener);
}
}
;
RestRequest.ErrorListener errorListener=new RestRequest.ErrorListener(){
@Override public void onErrorResponse(VolleyError volleyError){
AppLog.e(T.READER,volleyError);
if (resultListener != null) resultListener.onUpdateResult(ReaderActions.UpdateResult.FAILED,-1);
}
}
;
WordPress.getRestClientUtils().get(endpoint,null,null,listener,errorListener);
}
