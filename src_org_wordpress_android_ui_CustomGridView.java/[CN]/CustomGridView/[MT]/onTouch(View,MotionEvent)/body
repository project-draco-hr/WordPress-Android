{
  int x=(int)event.getX();
  int y=(int)event.getY();
  int action=event.getAction();
switch (action & MotionEvent.ACTION_MASK) {
case MotionEvent.ACTION_DOWN:
    lastX=x;
  lastY=y;
break;
case MotionEvent.ACTION_MOVE:
if (activeView == null) return super.onTouchEvent(event);
int delta_x=x - lastX;
int delta_y=y - lastY;
int l=(int)(activeView.getLeft() + delta_x);
int t=(int)(activeView.getTop() + delta_y);
int r=l + activeView.getWidth();
int b=t + activeView.getHeight();
activeView.layout(l,t,r,b);
int gap=getGap(x,y);
animateGap(gap);
int[] pos=getLocationOnScreen();
int bottom=pos[1] + getHeight();
if (y >= 0.66 * bottom && y > lastY) startScrollDown();
 else if (y <= 0.33 * bottom && y < lastY) startScrollUp();
 else stopScroll();
lastX=x;
lastY=y;
break;
case MotionEvent.ACTION_UP:
stopScroll();
gap=getGap(x,y);
animateActiveViewToGap(gap);
activeView=null;
activePos=-1;
break;
}
return false;
}
