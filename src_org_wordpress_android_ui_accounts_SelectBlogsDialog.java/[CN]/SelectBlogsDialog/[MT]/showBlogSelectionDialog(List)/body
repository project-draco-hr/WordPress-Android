{
  mUsersBlogsList=usersBlogsList;
  if (mUsersBlogsList == null) {
    mUsersBlogsList=new ArrayList();
  }
  if (mUsersBlogsList.size() == 0) {
    mListener.onSuccess(null);
    return;
  }
  if (mUsersBlogsList.size() == 1) {
    SparseBooleanArray oneBlogArray=new SparseBooleanArray();
    oneBlogArray.put(0,true);
    mListener.onSuccess(oneBlogArray);
    return;
  }
  if (mUsersBlogsList != null && mUsersBlogsList.size() != 0) {
    SparseBooleanArray allBlogs=new SparseBooleanArray();
    for (int i=0; i < mUsersBlogsList.size(); i++) {
      allBlogs.put(i,true);
    }
    LayoutInflater inflater=(LayoutInflater)mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    final ListView listView=(ListView)inflater.inflate(R.layout.select_blogs_list,null);
    listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
    listView.setItemsCanFocus(false);
    final UsersBlogsArrayAdapter adapter=new UsersBlogsArrayAdapter(mContext,R.layout.blogs_row,mUsersBlogsList);
    listView.setAdapter(adapter);
    AlertDialog.Builder dialogBuilder=new AlertDialog.Builder(mContext);
    dialogBuilder.setTitle(R.string.select_blogs);
    dialogBuilder.setView(listView);
    dialogBuilder.setNegativeButton(R.string.add_selected,new DialogInterface.OnClickListener(){
      public void onClick(      DialogInterface dialog,      int whichButton){
        SparseBooleanArray selectedBlogs=listView.getCheckedItemPositions();
        mListener.onSuccess(selectedBlogs);
      }
    }
);
    dialogBuilder.setPositiveButton(R.string.add_all,new DialogInterface.OnClickListener(){
      public void onClick(      DialogInterface dialog,      int whichButton){
        SparseBooleanArray allBlogs=new SparseBooleanArray();
        for (int i=0; i < adapter.getCount(); i++) {
          allBlogs.put(i,true);
        }
        mListener.onSuccess(allBlogs);
      }
    }
);
    dialogBuilder.setOnKeyListener(new ProgressDialog.OnKeyListener(){
      @Override public boolean onKey(      DialogInterface dialog,      int keyCode,      KeyEvent event){
        mListener.onCancel();
        return false;
      }
    }
);
    dialogBuilder.setCancelable(true);
    AlertDialog ad=dialogBuilder.create();
    ad.setInverseBackgroundForced(true);
    ad.show();
    final Button addSelected=ad.getButton(AlertDialog.BUTTON_NEGATIVE);
    addSelected.setEnabled(false);
    listView.setOnItemClickListener(new AdapterView.OnItemClickListener(){
      public void onItemClick(      AdapterView<?> arg0,      View arg1,      int arg2,      long arg3){
        SparseBooleanArray selectedItems=listView.getCheckedItemPositions();
        boolean isChecked=false;
        for (int i=0; i < selectedItems.size(); i++) {
          if (selectedItems.get(selectedItems.keyAt(i)) == true) {
            isChecked=true;
          }
        }
        if (!isChecked) {
          addSelected.setEnabled(false);
        }
 else {
          addSelected.setEnabled(true);
        }
      }
    }
);
  }
}
