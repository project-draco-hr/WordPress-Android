{
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_new_edit_post);
  final ActionBar actionBar=getSupportActionBar();
  actionBar.setDisplayHomeAsUpEnabled(true);
  mAutoSaveHandler=new Handler();
  mSectionsPagerAdapter=new SectionsPagerAdapter(getSupportFragmentManager());
  mViewPager=(WPViewPager)findViewById(R.id.pager);
  mViewPager.setAdapter(mSectionsPagerAdapter);
  mViewPager.setOffscreenPageLimit(2);
  mViewPager.setPagingEnabled(false);
  mViewPager.setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener(){
    @Override public void onPageSelected(    int position){
      supportInvalidateOptionsMenu();
      if (position == PAGE_CONTENT) {
        setTitle(WordPress.getCurrentBlog().getBlogName());
      }
 else       if (position == PAGE_SETTINGS) {
        setTitle(mPost.isPage() ? R.string.page_settings : R.string.post_settings);
      }
 else       if (position == PAGE_PREVIEW) {
        setTitle(mPost.isPage() ? R.string.preview_page : R.string.preview_post);
        savePost(false);
        if (mEditPostPreviewFragment != null)         mEditPostPreviewFragment.loadPost(mPost);
      }
    }
  }
);
  setTitle(WordPress.getCurrentBlog().getBlogName());
  Bundle extras=getIntent().getExtras();
  if (extras != null) {
    long postId=extras.getLong(EXTRA_POSTID,-1);
    boolean isPage=extras.getBoolean(EXTRA_IS_PAGE);
    mIsNewPost=extras.getBoolean(EXTRA_IS_NEW_POST);
    try {
      mPost=new Post(WordPress.getCurrentBlog().getId(),postId,isPage);
      if (mPost == null) {
        showPostErrorAndFinish();
        return;
      }
 else {
        mOriginalPost=new Post(WordPress.getCurrentBlog().getId(),postId,isPage);
      }
      if (isPage) {
        WPMobileStatsUtil.trackEventForWPCom(WPMobileStatsUtil.StatsEventPageDetailOpenedEditor);
        mStatEventEditorClosed=WPMobileStatsUtil.StatsEventPageDetailClosedEditor;
      }
 else {
        WPMobileStatsUtil.trackEventForWPCom(WPMobileStatsUtil.StatsEventPostDetailOpenedEditor);
        mStatEventEditorClosed=WPMobileStatsUtil.StatsEventPostDetailClosedEditor;
      }
    }
 catch (    Exception e) {
      showPostErrorAndFinish();
    }
  }
 else {
    showPostErrorAndFinish();
  }
  String action=getIntent().getAction();
  if (Intent.ACTION_SEND.equals(action) || Intent.ACTION_SEND_MULTIPLE.equals(action) || EditPostContentFragment.NEW_MEDIA_GALLERY.equals(action)|| EditPostContentFragment.NEW_MEDIA_POST.equals(action)|| (extras != null && extras.getInt("quick-media",-1) > -1)) {
    mPost=new Post(WordPress.getCurrentBlog().getId(),false);
    if (mPost.getId() < 0) {
      showPostErrorAndFinish();
    }
  }
}
