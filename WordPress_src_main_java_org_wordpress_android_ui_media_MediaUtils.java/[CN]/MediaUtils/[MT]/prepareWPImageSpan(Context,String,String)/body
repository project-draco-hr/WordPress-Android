{
  Cursor cursor=WordPress.wpDB.getMediaFile(blogId,mediaId);
  if (cursor == null || !cursor.moveToFirst()) {
    if (cursor != null)     cursor.close();
    return null;
  }
  String url=cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_FILE_URL));
  if (url == null) {
    cursor.close();
    return null;
  }
  String mimeType=cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_MIME_TYPE));
  boolean isVideo=mimeType != null && mimeType.contains("video");
  Uri uri=Uri.parse(url);
  WPImageSpan imageSpan=new WPImageSpan(context,isVideo ? R.drawable.media_movieclip : R.drawable.dashicon_format_image_big_grey,uri);
  MediaFile mediaFile=imageSpan.getMediaFile();
  mediaFile.setMediaId(mediaId);
  mediaFile.setBlogId(blogId);
  mediaFile.setCaption(cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_CAPTION)));
  mediaFile.setDescription(cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_DESCRIPTION)));
  mediaFile.setTitle(cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_TITLE)));
  mediaFile.setWidth(cursor.getInt(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_WIDTH)));
  mediaFile.setHeight(cursor.getInt(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_HEIGHT)));
  mediaFile.setMimeType(mimeType);
  mediaFile.setFileName(cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_FILE_NAME)));
  mediaFile.setThumbnailURL(cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_THUMBNAIL_URL)));
  mediaFile.setDateCreatedGMT(cursor.getLong(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_DATE_CREATED_GMT)));
  mediaFile.setVideoPressShortCode(cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_VIDEO_PRESS_SHORTCODE)));
  mediaFile.setFileURL(cursor.getString(cursor.getColumnIndex(WordPressDB.COLUMN_NAME_FILE_URL)));
  mediaFile.setVideo(isVideo);
  mediaFile.save();
  cursor.close();
  return imageSpan;
}
