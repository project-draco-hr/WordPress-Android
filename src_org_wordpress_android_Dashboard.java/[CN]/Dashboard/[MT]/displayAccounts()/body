{
  WordPressDB settingsDB=new WordPressDB(this);
  accounts=settingsDB.getAccounts(this);
  checkStats(accounts.size());
  if (accounts.size() > 0) {
    ImageButton home=(ImageButton)findViewById(R.id.home_small);
    ImageButton add=(ImageButton)findViewById(R.id.add_small);
    try {
      ImageView i=(ImageView)findViewById(R.id.blavatar_img);
      Bitmap bitmap=BitmapFactory.decodeStream((InputStream)new URL(blavatar_url).getContent());
      i.setImageBitmap(bitmap);
    }
 catch (    MalformedURLException e) {
      e.printStackTrace();
    }
catch (    IOException e) {
      e.printStackTrace();
    }
    blogIDs=new int[accounts.size()];
    for (int i=0; i < accounts.size(); i++) {
      HashMap<?,?> defHash=(HashMap<?,?>)accounts.get(i);
      String curBlogName=EscapeUtils.unescapeHtml(defHash.get("blogName").toString());
      defBlogNames.add(curBlogName);
      blogIDs[i]=Integer.valueOf(defHash.get("id").toString());
    }
    final Spinner blog_select=(Spinner)findViewById(R.id.blogname);
    ArrayAdapter blog_list=new ArrayAdapter(this,android.R.layout.simple_spinner_item,defBlogNames);
    blog_select.setAdapter(blog_list);
    blog_select.setOnItemSelectedListener(new OnItemSelectedListener(){
      public void onItemSelected(      AdapterView<?> parentView,      View selectedItemView,      int position,      long row_id){
        WordPressDB wpDB=new WordPressDB(Dashboard.this);
        wpDB.updateLastBlogID(Dashboard.this,blogIDs[position]);
        id=String.valueOf(blogIDs[position]);
      }
      public void onNothingSelected(      AdapterView<?> parentView){
      }
    }
);
    int lastBlogID=settingsDB.getLastBlogID(this);
    if (lastBlogID != -1) {
      try {
        boolean matchedID=false;
        for (int i=0; i < blogIDs.length; i++) {
          if (blogIDs[i] == lastBlogID) {
            blog_select.setSelection(i);
            matchedID=true;
          }
        }
        if (!matchedID) {
          blog_select.setSelection(0);
        }
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
 else {
      blog_select.setSelection(0);
    }
    Integer blog_num=blog_select.getSelectedItemPosition();
    blog_num=blog_num + 1;
    id=blog_num.toString();
    home.setOnClickListener(new OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,wpAndroid.class);
        startActivity(i);
      }
    }
);
    final ActionItem newpost=new ActionItem();
    newpost.setTitle("Add New Post");
    newpost.setIcon(getResources().getDrawable(R.drawable.posts_tab));
    newpost.setOnClickListener(new OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,EditPost.class);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("id",id);
        i.putExtra("isNew",true);
        startActivityForResult(i,0);
        if (qa != null)         qa.dismiss();
      }
    }
);
    final ActionItem newpage=new ActionItem();
    newpage.setTitle("Add New Page");
    newpage.setIcon(getResources().getDrawable(R.drawable.pages_tab));
    newpage.setOnClickListener(new OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,EditPost.class);
        i.putExtra("id",id);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("isNew",true);
        i.putExtra("isPage",true);
        startActivityForResult(i,0);
      }
    }
);
    final ActionItem addOldPhoto=new ActionItem();
    addOldPhoto.setTitle("Add Image From Gallery");
    addOldPhoto.setIcon(getResources().getDrawable(R.drawable.media));
    addOldPhoto.setOnClickListener(new OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,EditPost.class);
        i.putExtra("id",id);
        i.putExtra("isNew",true);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("viewPages",true);
        i.putExtra("option","photoPicker");
        startActivityForResult(i,0);
      }
    }
);
    final ActionItem takeNewPhoto=new ActionItem();
    takeNewPhoto.setTitle("Take Photo");
    takeNewPhoto.setIcon(getResources().getDrawable(R.drawable.media));
    takeNewPhoto.setOnClickListener(new OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,EditPost.class);
        i.putExtra("id",id);
        i.putExtra("isNew",true);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("viewPages",true);
        i.putExtra("option","takePhotoFromCamera");
        startActivityForResult(i,0);
      }
    }
);
    final ActionItem addOldVideo=new ActionItem();
    addOldVideo.setTitle("Add Video from Gallery");
    addOldVideo.setIcon(getResources().getDrawable(R.drawable.media));
    addOldVideo.setOnClickListener(new OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,EditPost.class);
        i.putExtra("id",id);
        i.putExtra("isNew",true);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("viewPages",true);
        i.putExtra("option","videoPicker");
        startActivityForResult(i,0);
      }
    }
);
    final ActionItem takeNewVideo=new ActionItem();
    takeNewVideo.setTitle("Take Video");
    takeNewVideo.setIcon(getResources().getDrawable(R.drawable.media));
    takeNewVideo.setOnClickListener(new OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,EditPost.class);
        i.putExtra("id",id);
        i.putExtra("isNew",true);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("viewPages",true);
        i.putExtra("option","takeVideo");
        startActivityForResult(i,0);
      }
    }
);
    add.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        Integer blog_num=blog_select.getSelectedItemPosition();
        blog_num=blog_num + 1;
        id=blog_num.toString();
        qa=new QuickAction(v);
        qa.addActionItem(newpost);
        qa.addActionItem(newpage);
        qa.addActionItem(addOldPhoto);
        qa.addActionItem(takeNewPhoto);
        qa.addActionItem(addOldVideo);
        qa.addActionItem(takeNewVideo);
        qa.setAnimStyle(QuickAction.ANIM_AUTO);
        qa.show();
      }
    }
);
    Button postsButton=(Button)findViewById(R.id.dashboard_posts_btn);
    postsButton.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,ViewPosts.class);
        i.putExtra("id",id);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("isNew",true);
        startActivityForResult(i,0);
      }
    }
);
    Button pagesButton=(Button)findViewById(R.id.dashboard_pages_btn);
    pagesButton.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,ViewPosts.class);
        i.putExtra("id",id);
        i.putExtra("isNew",true);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("viewPages",true);
        startActivityForResult(i,0);
      }
    }
);
    Button draftsButton=(Button)findViewById(R.id.dashboard_drafts_btn);
    draftsButton.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,ViewDrafts.class);
        i.putExtra("id",id);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("isNew",true);
        startActivityForResult(i,0);
      }
    }
);
    Button commentsButton=(Button)findViewById(R.id.dashboard_comments_btn);
    commentsButton.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,ViewComments.class);
        i.putExtra("id",id);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("isNew",true);
        startActivityForResult(i,0);
      }
    }
);
    Button statsButton=(Button)findViewById(R.id.dashboard_stats_btn);
    statsButton.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,ViewStats.class);
        i.putExtra("id",id);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("isNew",true);
        startActivityForResult(i,0);
      }
    }
);
    Button settingsButton=(Button)findViewById(R.id.dashboard_settings_btn);
    settingsButton.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        Intent i=new Intent(Dashboard.this,Settings.class);
        i.putExtra("id",id);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("isNew",true);
        startActivityForResult(i,0);
      }
    }
);
    final Button quickpress=(Button)findViewById(R.id.quickpress);
    quickpress.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        Integer blog_num=blog_select.getSelectedItemPosition();
        blog_num=blog_num + 1;
        id=blog_num.toString();
        Intent i=new Intent(Dashboard.this,EditPost.class);
        i.putExtra("blavatar",blavatar_url);
        i.putExtra("id",id);
        i.putExtra("isNew",true);
        i.putExtra("option","");
        startActivityForResult(i,0);
      }
    }
);
  }
 else {
    Intent i=new Intent(Dashboard.this,NewAccount.class);
    startActivityForResult(i,0);
  }
}
