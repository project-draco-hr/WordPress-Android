{
  final boolean useGridView=useGridView();
  final Context context=container.getContext();
  final int actionbarHeight=DisplayUtils.getActionBarHeight(context);
  final boolean isTranslucentActionBarEnabled=NativeReaderActivity.isTranslucentActionBarEnabled();
  final View view;
  if (useGridView) {
    view=inflater.inflate(R.layout.reader_fragment_post_grid,container,false);
  }
 else {
    view=inflater.inflate(R.layout.reader_fragment_post_list,container,false);
  }
  mNewPostsBar=(TextView)view.findViewById(R.id.text_new_posts);
  mNewPostsBar.setVisibility(View.GONE);
  mNewPostsBar.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View view){
      reloadPosts();
      hideNewPostsBar();
    }
  }
);
  mEmptyMessage=(TextView)view.findViewById(R.id.text_empty);
  if (isTranslucentActionBarEnabled) {
    RelativeLayout.LayoutParams params=(RelativeLayout.LayoutParams)mNewPostsBar.getLayoutParams();
    params.setMargins(0,actionbarHeight,0,0);
    mEmptyMessage.setPadding(0,actionbarHeight,0,0);
  }
  if (useGridView) {
    final StaggeredGridView gridView=(StaggeredGridView)view.findViewById(R.id.grid);
    gridView.setOnTouchListener(this);
    if (isTranslucentActionBarEnabled) {
      RelativeLayout header=new RelativeLayout(context);
      header.setLayoutParams(new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.MATCH_PARENT,RelativeLayout.LayoutParams.WRAP_CONTENT));
      header.setMinimumHeight(actionbarHeight - (gridView.getItemMargin() * 2));
      gridView.setHeaderView(header);
      if (hasActivity() && getActivity() instanceof NativeReaderActivity)       ((NativeReaderActivity)getActivity()).setActionBarAlpha(NativeReaderActivity.ALPHA_LEVEL_3);
    }
    mFooterProgress=inflater.inflate(R.layout.reader_footer_progress,gridView,false);
    gridView.setFooterView(mFooterProgress);
    gridView.setOnItemClickListener(new StaggeredGridView.OnItemClickListener(){
      @Override public void onItemClick(      StaggeredGridView parent,      View view,      int position,      long id){
        position-=gridView.getHeaderViewsCount();
        ReaderPost post=(ReaderPost)getPostAdapter().getItem(position);
        ReaderActivityLauncher.showReaderPostDetailForResult(getActivity(),post);
      }
    }
);
    gridView.setAdapter(getPostAdapter());
  }
 else {
    final ListView listView=(ListView)view.findViewById(android.R.id.list);
    listView.setOnTouchListener(this);
    listView.setOnScrollListener(this);
    mFooterProgress=inflater.inflate(R.layout.reader_footer_progress,listView,false);
    listView.addFooterView(mFooterProgress);
    if (isTranslucentActionBarEnabled) {
      int headerHeight=actionbarHeight - getResources().getDimensionPixelSize(R.dimen.reader_divider_size);
      RelativeLayout header=new RelativeLayout(context);
      header.setLayoutParams(new AbsListView.LayoutParams(AbsListView.LayoutParams.MATCH_PARENT,headerHeight));
      listView.addHeaderView(header,null,false);
      initListViewOverscroll(listView);
    }
    listView.setOnItemClickListener(new AdapterView.OnItemClickListener(){
      @Override public void onItemClick(      AdapterView<?> adapterView,      View view,      int position,      long id){
        position-=listView.getHeaderViewsCount();
        ReaderPost post=(ReaderPost)getPostAdapter().getItem(position);
        ReaderActivityLauncher.showReaderPostDetailForResult(getActivity(),post);
      }
    }
);
    listView.setAdapter(getPostAdapter());
  }
  mFooterProgress.setVisibility(View.GONE);
  mFooterProgress.setBackgroundColor(context.getResources().getColor(R.color.reader_divider_grey));
  return view;
}
