{
  int itemId=item.getItemId();
  if (itemId == android.R.id.home) {
    FragmentManager fm=getSupportFragmentManager();
    if (fm.getBackStackEntryCount() > 0) {
      fm.popBackStack();
      return true;
    }
  }
 else   if (itemId == R.id.menu_new_media) {
    Intent i=new Intent(this,MediaUploadActivity.class);
    i.putExtra("id",WordPress.currentBlog.getId());
    startActivity(i);
    return true;
  }
 else   if (itemId == R.id.menu_search) {
    mSearchMenuItem=item;
    mSearchMenuItem.setOnActionExpandListener(this);
    mSearchMenuItem.expandActionView();
    mSearchView=(SearchView)item.getActionView();
    mSearchView.setOnQueryTextListener(this);
    return true;
  }
 else   if (itemId == R.id.menu_refresh) {
    if (mMediaGridFragment != null) {
      mMediaGridFragment.refreshMediaFromServer(0);
      startAnimatingRefreshButton();
    }
    return true;
  }
 else   if (itemId == R.id.menu_edit_media) {
    String mediaId=mMediaItemFragment.getMediaId();
    FragmentManager fm=getSupportFragmentManager();
    if (mMediaEditFragment == null || !mMediaEditFragment.isInLayout()) {
      FragmentTransaction ft=fm.beginTransaction();
      ft.hide(mMediaItemFragment);
      mMediaEditFragment=MediaEditFragment.newInstance(mediaId);
      ft.add(R.id.media_browser_container,mMediaEditFragment);
      ft.addToBackStack(null);
      ft.commit();
      mMenuDrawer.setDrawerIndicatorEnabled(false);
    }
 else {
      mMediaItemFragment.loadMedia(mediaId);
    }
    if (mSearchView != null)     mSearchView.clearFocus();
  }
 else   if (itemId == R.id.menu_delete) {
    Builder builder=new AlertDialog.Builder(this).setMessage(R.string.confirm_delete_media).setCancelable(true).setPositiveButton(R.string.delete,new OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        if (mMediaItemFragment != null && mMediaItemFragment.isVisible()) {
          ArrayList<String> ids=new ArrayList<String>(1);
          ids.add(mMediaItemFragment.getMediaId());
          onDeleteMedia(ids);
        }
      }
    }
).setNegativeButton(R.string.cancel,null);
    AlertDialog dialog=builder.create();
    dialog.show();
  }
  return super.onOptionsItemSelected(item);
}
