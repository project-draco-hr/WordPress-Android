{
  if (mPost == null || context == null) {
    return "";
  }
  String content;
  if (mPost.hasText()) {
    content=mPost.getText().replace("src=\"//","src=\"http://");
    if (mPost.isVideoPress)     content=makeVideoDiv(mPost.getFeaturedVideo(),mPost.getFeaturedImage()) + content;
  }
 else   if (mPost.hasFeaturedImage()) {
    content=String.format("<p><img class='img.size-full' src='%s' /></p>",mPost.getFeaturedImage());
  }
 else {
    content="";
  }
  int marginLarge=context.getResources().getDimensionPixelSize(R.dimen.margin_large);
  int marginSmall=context.getResources().getDimensionPixelSize(R.dimen.margin_small);
  int marginExtraSmall=context.getResources().getDimensionPixelSize(R.dimen.margin_extra_small);
  int fullSizeImageWidth=getFullSizeImageWidth();
  final String linkColor=HtmlUtils.colorResToHtmlColor(context,R.color.reader_hyperlink);
  final String greyLight=HtmlUtils.colorResToHtmlColor(context,R.color.grey_light);
  final String greyExtraLight=HtmlUtils.colorResToHtmlColor(context,R.color.grey_extra_light);
  StringBuilder sbHtml=new StringBuilder("<!DOCTYPE html><html><head><meta charset='UTF-8' />");
  sbHtml.append("<title>Reader Post</title>");
  sbHtml.append("<meta name='viewport' content='width=device-width, initial-scale=1'>");
  sbHtml.append("<link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Open+Sans' />");
  sbHtml.append("<style type='text/css'>").append("  body { font-family: 'Open Sans', sans-serif; margin: 0px; padding: 0px;}").append("  body, p, div { max-width: 100% !important;}").append("  p, div { line-height: 1.6em; font-size: 1em; }").append("  h1, h2 { line-height: 1.2em; }");
  sbHtml.append(String.format("  p { margin-top: %dpx; margin-bottom: %dpx; }",marginSmall,marginSmall)).append("    p:first-child { margin-top: 0px; }");
  sbHtml.append("  pre { overflow-x: scroll;").append("        border: 1px solid ").append(greyLight).append("; ").append("        background-color: ").append(greyExtraLight).append("; ").append("        padding: ").append(marginSmall).append("px; }");
  sbHtml.append("  a { word-wrap: break-word; text-decoration: none; color: ").append(linkColor).append("; }");
  if (hasEmbedsOrIframes()) {
    int videoWidth=DisplayUtils.pxToDp(context,fullSizeImageWidth - (marginLarge * 2));
    int videoHeight=(int)(videoWidth * 0.5625f);
    sbHtml.append("  iframe, embed { width: ").append(videoWidth).append("px !important;").append("                  height: ").append(videoHeight).append("px !important; }");
  }
 else {
    sbHtml.append("  iframe, embed { display: none; }");
  }
  sbHtml.append("  img { max-width: 100% !important; height: auto;}");
  sbHtml.append("  img.size-full, img.size-large { display: block; width: 100% !important; height: auto; }");
  sbHtml.append("  img.size-medium { display: block; margin-left: auto !important; margin-right: auto !important; }");
  if (content.contains("tiled-gallery-item")) {
    String widthParam="w=" + Integer.toString(fullSizeImageWidth);
    content=content.replaceAll("w=[0-9]+",widthParam).replaceAll("h=[0-9]+","");
    sbHtml.append("  div.gallery-row, div.gallery-group { width: auto !important; height: auto !important; }").append("  div.tiled-gallery-item img { ").append("     width: auto !important; height: auto !important;").append("     margin-top: ").append(marginExtraSmall).append("px; ").append("     margin-bottom: ").append(marginExtraSmall).append("px; ").append(" }").append("  div.tiled-gallery-caption { clear: both; }");
  }
  sbHtml.append("</style></head><body>").append(content).append("</body></html>");
  return sbHtml.toString();
}
