{
  float ratio=attachment.getHWRatio();
  if (ratio == 0) {
    AppLog.w(AppLog.T.READER,"reader renderer > empty image ratio");
    return;
  }
  int width=mResourceVars.fullSizeImageWidth;
  int height=(int)(width * ratio);
  final String newImageUrl;
  if (mPost.isPrivate) {
    newImageUrl=ReaderUtils.getPrivateImageForDisplay(attachment.getUrl(),width,height);
  }
 else {
    newImageUrl=PhotonUtils.getPhotonImageUrl(attachment.getUrl(),width,height);
  }
  String newImageTag=String.format("<img class='size-full' src='%s' width='%d' height='%d' />",newImageUrl,width,height);
  int start=mRenderBuilder.indexOf(imageTag);
  if (start == -1) {
    AppLog.w(AppLog.T.READER,"reader renderer > image not found in builder");
    return;
  }
  mRenderBuilder.replace(start,start + imageTag.length(),newImageTag);
}
