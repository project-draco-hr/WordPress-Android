{
  SharedPreferences settings=PreferenceManager.getDefaultSharedPreferences(ctx);
  String uuid=settings.getString("wp_pref_notifications_uuid",null);
  if (uuid == null)   return;
  String deviceName=DeviceUtils.getInstance().getDeviceName(ctx);
  Map<String,String> contentStruct=new HashMap<String,String>();
  contentStruct.put("device_token",token);
  contentStruct.put("device_family","android");
  contentStruct.put("app_secret_key",NotificationUtils.getAppPushNotificationsName());
  contentStruct.put("device_name",deviceName);
  contentStruct.put("device_model",Build.MANUFACTURER + " " + Build.MODEL);
  contentStruct.put("app_version",WordPress.versionName);
  contentStruct.put("os_version",android.os.Build.VERSION.RELEASE);
  contentStruct.put("device_uuid",uuid);
  contentStruct.put("testing","io non dovrei essere qua");
  com.wordpress.rest.RestRequest.Listener listener=new RestRequest.Listener(){
    @Override public void onResponse(    JSONObject jsonObject){
      ReaderLog.d("Register token action succeeded");
      if (loadSettings) {
        com.wordpress.rest.RestRequest.Listener listener=new RestRequest.Listener(){
          @Override public void onResponse(          JSONObject jsonObject){
            ReaderLog.d("token action succeeded");
            SharedPreferences settings=PreferenceManager.getDefaultSharedPreferences(ctx);
            Editor editor=settings.edit();
            try {
              JSONObject settingsJSON=jsonObject.getJSONObject("settings");
              editor.putString("wp_pref_notification_settings",settingsJSON.toString());
              editor.commit();
            }
 catch (            JSONException e) {
              e.printStackTrace();
            }
          }
        }
;
        NotificationUtils.getPushNotificationSettings(ctx,listener,null);
      }
    }
  }
;
  RestRequest.ErrorListener errorListener=new RestRequest.ErrorListener(){
    @Override public void onErrorResponse(    VolleyError volleyError){
      ReaderLog.w("Register token action failed");
      ReaderLog.e(volleyError);
    }
  }
;
  WordPress.restClient.post("/push/register",contentStruct,null,listener,errorListener);
}
