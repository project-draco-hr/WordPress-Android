{
  HurlStack stack=new HurlStack(){
    @Override public HttpResponse performRequest(    Request<?> request,    Map<String,String> headers) throws IOException, AuthFailureError {
      addDefaultHeaders(request,headers,null);
      if (request.getUrl() != null && StringUtils.getHost(request.getUrl()).endsWith("files.wordpress.com") && WordPress.getWPComAuthToken(ctx) != null) {
        HashMap<String,String> authParams=new HashMap<String,String>();
        authParams.put("Authorization","Bearer " + WordPress.getWPComAuthToken(ctx));
        headers.putAll(authParams);
      }
      return super.performRequest(request,headers);
    }
  }
;
  return stack;
}
