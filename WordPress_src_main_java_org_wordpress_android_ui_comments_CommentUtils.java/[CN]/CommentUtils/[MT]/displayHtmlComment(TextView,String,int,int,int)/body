{
  if (textView == null)   return;
  if (content == null) {
    textView.setText(null);
    return;
  }
  if (!content.contains("<") && !content.contains("&")) {
    textView.setText(content.trim());
    if (content.contains("://"))     Linkify.addLinks(textView,Linkify.WEB_URLS);
    return;
  }
  content=Emoticons.replaceEmoticonsWithEmoji(content);
  final Spanned html;
  if (maxImageSize > 0 && content.contains("<img")) {
    Drawable loading=textView.getContext().getResources().getDrawable(R.drawable.remote_image);
    Drawable failed=textView.getContext().getResources().getDrawable(R.drawable.remote_failed);
    html=HtmlUtils.fromHtml(content,new WPImageGetter(textView,maxImageSize,WordPress.imageLoader,loading,failed));
  }
 else {
    html=HtmlUtils.fromHtml(content);
  }
  CharSequence source=html;
  int start=0;
  int end=source.length();
  while (start < end && Character.isWhitespace(source.charAt(start))) {
    start++;
  }
  while (end > start && Character.isWhitespace(source.charAt(end - 1))) {
    end--;
  }
  if (textOffsetX > 0) {
    float textLineHeight=textView.getPaint().getTextSize();
    int lines=Math.round(textOffsetY / textLineHeight);
    SpannableString ss=new SpannableString(source.subSequence(start,end));
    ss.setSpan(new TextWrappingLeadingMarginSpan(lines,textOffsetX),0,ss.length(),Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    textView.setText(ss);
  }
 else {
    textView.setText(source.subSequence(start,end));
  }
}
