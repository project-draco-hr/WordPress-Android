{
  if (WordPress.getCurrentBlog() == null)   return;
  if (!NetworkUtils.isNetworkAvailable(this))   return;
  String blogId;
  if (WordPress.getCurrentBlog().isDotcomFlag() && dotComCredentialsMatch())   blogId=String.valueOf(WordPress.getCurrentBlog().getRemoteBlogId());
 else {
    blogId=getBlogId();
    if (blogId == null) {
      new ApiHelper.RefreshBlogContentTask(this,WordPress.getCurrentBlog(),new VerifyJetpackSettingsCallback(StatsActivity.this)).execute(false);
      return;
    }
  }
  StatsRestHelper.getStatsSummary(blogId,new StatsRestHelper.StatsSummaryInterface(){
    @Override public void onSuccess(){
    }
    @Override public void onFailure(    VolleyError error){
      if (mSignInDialog != null && mSignInDialog.isShowing()) {
        return;
      }
      if (isFinishing())       return;
      if (error.networkResponse != null && error.networkResponse.statusCode == 403) {
        AlertDialog.Builder builder=new AlertDialog.Builder(StatsActivity.this);
        builder.setTitle(getString(R.string.jetpack_stats_unauthorized)).setMessage(getString(R.string.jetpack_stats_switch_user));
        builder.setPositiveButton(R.string.yes,new DialogInterface.OnClickListener(){
          public void onClick(          DialogInterface dialog,          int id){
            startWPComLoginActivity();
          }
        }
);
        builder.setNegativeButton(R.string.no,new DialogInterface.OnClickListener(){
          public void onClick(          DialogInterface dialog,          int id){
          }
        }
);
        mSignInDialog=builder.create();
        mSignInDialog.show();
        return;
      }
      ToastUtils.showToastOrAuthAlert(StatsActivity.this,error,StatsActivity.this.getString(R.string.error_refresh_stats));
    }
  }
);
  Intent intent=new Intent(this,StatsService.class);
  intent.putExtra(StatsService.ARG_BLOG_ID,blogId);
  startService(intent);
}
