{
  Bitmap resizedBitmap=null;
  String imageTitle="";
  if (!imgPath.contains("video")) {
    String[] projection=new String[]{Images.Thumbnails._ID,Images.Thumbnails.DATA,Images.Media.ORIENTATION};
    String orientation="", path="";
    Cursor cur=managedQuery(curStream,projection,null,null,null);
    File jpeg=null;
    if (cur != null) {
      String thumbData="";
      if (cur.moveToFirst()) {
        int dataColumn, orientationColumn;
        dataColumn=cur.getColumnIndex(Images.Media.DATA);
        orientationColumn=cur.getColumnIndex(Images.Media.ORIENTATION);
        thumbData=cur.getString(dataColumn);
        orientation=cur.getString(orientationColumn);
      }
      jpeg=new File(thumbData);
      path=thumbData;
    }
 else {
      path=curStream.toString().replace("file://","");
      jpeg=new File(curStream.toString().replace("file://",""));
    }
    imageTitle=jpeg.getName();
    byte[] finalBytes=null;
    byte[] bytes=new byte[(int)jpeg.length()];
    DataInputStream in=null;
    try {
      in=new DataInputStream(new FileInputStream(jpeg));
    }
 catch (    FileNotFoundException e) {
      e.printStackTrace();
    }
    try {
      in.readFully(bytes);
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
    try {
      in.close();
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
    ImageHelper ih=new ImageHelper();
    if (orientation == "") {
      orientation=ih.getExifOrientation(path,orientation);
    }
    Display display=getWindowManager().getDefaultDisplay();
    int width=display.getWidth();
    imageTitle=jpeg.getName();
    finalBytes=ih.createThumbnail(bytes,String.valueOf(width / 2),orientation,true);
    resizedBitmap=BitmapFactory.decodeByteArray(finalBytes,0,finalBytes.length);
  }
 else {
  }
  WPEditText content=(WPEditText)findViewById(R.id.postContent);
  int selectionStart=content.getSelectionStart();
  styleStart=selectionStart;
  int selectionEnd=content.getSelectionEnd();
  if (selectionStart > selectionEnd) {
    int temp=selectionEnd;
    selectionEnd=selectionStart;
    selectionStart=temp;
  }
  CharSequence beforeText=content.getText().subSequence(0,selectionStart);
  CharSequence afterText=content.getText().subSequence(selectionStart,selectionEnd);
  SpannableStringBuilder builder=new SpannableStringBuilder();
  builder.append(beforeText);
  builder.append(" ");
  builder.append(afterText);
  WPImageSpan is=new WPImageSpan(EditContent.this,resizedBitmap,curStream);
  is.setTitle(imageTitle);
  is.setImageSource(curStream);
  builder.setSpan(is,selectionStart,selectionEnd + 1,Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
  AlignmentSpan.Standard as=new AlignmentSpan.Standard(Layout.Alignment.ALIGN_CENTER);
  builder.setSpan(as,selectionStart,selectionEnd + 1,Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
  builder.append("\r\n\r\n");
  content.setText(builder);
}
