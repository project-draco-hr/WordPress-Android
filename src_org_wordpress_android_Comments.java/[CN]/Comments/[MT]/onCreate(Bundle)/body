{
  super.onCreate(savedInstanceState);
  setContentView(R.layout.comments);
  titleBar=(WPTitleBar)findViewById(R.id.commentsActionBar);
  Bundle extras=getIntent().getExtras();
  if (extras != null) {
    fromNotification=extras.getBoolean("fromNotification");
    if (fromNotification) {
      try {
        WordPress.currentBlog=new Blog(extras.getInt("id"),Comments.this);
      }
 catch (      Exception e) {
        Toast.makeText(this,getResources().getText(R.string.blog_not_found),Toast.LENGTH_SHORT).show();
        finish();
      }
      titleBar.refreshBlog();
    }
  }
  FragmentManager fm=getSupportFragmentManager();
  commentList=(ViewComments)fm.findFragmentById(R.id.commentList);
  WordPress.currentComment=null;
  titleBar.refreshButton.setOnClickListener(new ImageButton.OnClickListener(){
    public void onClick(    View v){
      attemptToSelectComment();
      commentList.refreshComments(false,false,false);
    }
  }
);
  titleBar.setOnBlogChangedListener(new OnBlogChangedListener(){
    @Override public void OnBlogChanged(){
      FragmentManager fm=getSupportFragmentManager();
      ViewPostFragment f=(ViewPostFragment)fm.findFragmentById(R.id.commentDetail);
      if (f == null) {
        fm.popBackStack();
      }
      attemptToSelectComment();
      boolean commentsLoaded=commentList.loadComments(false,false);
      if (!commentsLoaded)       commentList.refreshComments(false,false,false);
    }
  }
);
  attemptToSelectComment();
  if (fromNotification)   commentList.refreshComments(false,false,false);
}
