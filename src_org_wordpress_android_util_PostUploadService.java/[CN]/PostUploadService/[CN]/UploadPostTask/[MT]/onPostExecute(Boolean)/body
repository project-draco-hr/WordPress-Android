{
  if (postUploadedSuccessfully) {
    WordPress.postUploaded();
    nm.cancel(notificationID);
    WordPress.wpDB.deleteMediaFilesForPost(post);
  }
 else {
    String postOrPage=(String)(post.isPage() ? context.getResources().getText(R.string.page_id) : context.getResources().getText(R.string.post_id));
    Intent notificationIntent=new Intent(context,(post.isPage()) ? PagesActivity.class : PostsActivity.class);
    notificationIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK | IntentCompat.FLAG_ACTIVITY_CLEAR_TASK);
    notificationIntent.setAction("android.intent.action.MAIN");
    notificationIntent.addCategory("android.intent.category.LAUNCHER");
    notificationIntent.setData((Uri.parse("custom://wordpressNotificationIntent" + post.getBlogID())));
    notificationIntent.putExtra("errorMessage",mErrorMessage);
    if (mErrorUnavailableVideoPress) {
      notificationIntent.putExtra("errorInfoTitle",getString(R.string.learn_more));
      notificationIntent.putExtra("errorInfoLink",Constants.videoPressURL);
    }
    notificationIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    PendingIntent pendingIntent=PendingIntent.getActivity(context,0,notificationIntent,PendingIntent.FLAG_UPDATE_CURRENT);
    n.flags|=Notification.FLAG_AUTO_CANCEL;
    String errorText=context.getResources().getText(R.string.upload_failed).toString();
    if (mIsMediaError)     errorText=context.getResources().getText(R.string.media) + " " + context.getResources().getText(R.string.error);
    n.setLatestEventInfo(context,(mIsMediaError) ? errorText : context.getResources().getText(R.string.upload_failed),(mIsMediaError) ? mErrorMessage : postOrPage + " " + errorText+ ": "+ mErrorMessage,pendingIntent);
    nm.notify(notificationID,n);
  }
  postUploaded();
}
