{
  if (mLanguagePreference == null)   return;
  Resources res=getResources();
  Configuration conf=res.getConfiguration();
  String[] availableLocales=getResources().getStringArray(R.array.available_languages);
  Arrays.sort(availableLocales);
  mLanguagePreference.setEntryValues(availableLocales);
  if (TextUtils.isEmpty(mLanguagePreference.getSummary())) {
    mLanguagePreference.setValue(conf.locale.toString());
    mLanguagePreference.setSummary(WPPrefUtils.getLanguageString(conf.locale.toString(),conf.locale));
  }
  CharSequence[] languageCodes=mLanguagePreference.getEntryValues();
  mLanguagePreference.setEntries(WPPrefUtils.createLanguageDisplayStrings(languageCodes));
  mLanguagePreference.setDetails(WPPrefUtils.createLanguageDetailDisplayStrings(languageCodes,conf.locale.getLanguage()));
  mLanguagePreference.refreshAdapter();
}
