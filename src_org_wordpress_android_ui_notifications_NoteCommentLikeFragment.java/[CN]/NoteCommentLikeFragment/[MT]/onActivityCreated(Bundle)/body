{
  super.onActivityCreated(bundle);
  ListView list=getListView();
  list.setDivider(getResources().getDrawable(R.drawable.list_divider));
  list.setDividerHeight(1);
  list.setHeaderDividersEnabled(false);
  if (getNote() == null)   return;
  JSONArray bodyItems=getNote().queryJSON("body.items",new JSONArray());
  JSONObject bodyObject=getNote().queryJSON("body",new JSONObject());
  final String headerSubject=getHeaderText(bodyItems);
  final String headerSnippet=getCommentSnippet(bodyItems);
  final String headerLink=(bodyObject != null ? JSONUtil.getString(bodyObject,"header_link") : "");
  final DetailHeader noteHeader=(DetailHeader)getView().findViewById(R.id.header);
  if (TextUtils.isEmpty(headerSnippet)) {
    noteHeader.setText(headerSubject);
  }
 else {
    noteHeader.setText(headerSubject + " \"" + headerSnippet+ "\"");
  }
  noteHeader.setNote(getNote(),headerLink);
  if (getActivity() instanceof OnPostClickListener) {
    noteHeader.setOnPostClickListener(((OnPostClickListener)getActivity()));
  }
  if (getActivity() instanceof OnCommentClickListener) {
    noteHeader.setOnCommentClickListener(((OnCommentClickListener)getActivity()));
  }
  setListAdapter(new NoteAdapter(getActivity()));
  NotificationUtils.updateNotification(getNoteId(),this);
}
